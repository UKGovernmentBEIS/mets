<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog logicalFilePath="v0.2.0/changelog_authorization_rules.xml"
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.11.xsd">

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_AIR_RFI_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'AIR_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
            <sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AIR_RFI_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
            </sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_AIR_WAIT_FOR_RFI_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'AIR_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AIR_WAIT_FOR_RFI_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_AVIATION_VIR_RFI_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'AVIATION_VIR_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_VIR_RFI_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_AVIATION_VIR_WAIT_FOR_RFI_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'AVIATION_VIR_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_VIR_WAIT_FOR_RFI_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_CORSIA_CONFIRM_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_CORSIA_CONFIRM_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_ISSUANCE_CORSIA_CONFIRM_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_CORSIA_MAKE_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_CORSIA_MAKE_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_ISSUANCE_CORSIA_MAKE_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_CORSIA_RDE_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_CORSIA_RDE_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_ISSUANCE_CORSIA_RDE_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_CORSIA_RFI_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_CORSIA_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_ISSUANCE_CORSIA_RFI_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_CORSIA_TRACK_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_CORSIA_TRACK_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_ISSUANCE_CORSIA_TRACK_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_CORSIA_WAIT_FOR_RDE_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_CORSIA_WAIT_FOR_RDE_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_ISSUANCE_CORSIA_WAIT_FOR_RDE_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_CORSIA_WAIT_FOR_RFI_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_CORSIA_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_ISSUANCE_CORSIA_WAIT_FOR_RFI_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_UKETS_CONFIRM_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_UKETS_CONFIRM_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_ISSUANCE_UKETS_CONFIRM_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_UKETS_MAKE_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_UKETS_MAKE_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_ISSUANCE_UKETS_MAKE_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_UKETS_RDE_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_UKETS_RDE_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_ISSUANCE_UKETS_RDE_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_UKETS_RFI_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_UKETS_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_ISSUANCE_UKETS_RFI_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_UKETS_TRACK_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_UKETS_TRACK_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_ISSUANCE_UKETS_TRACK_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_UKETS_WAIT_FOR_RDE_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_UKETS_WAIT_FOR_RDE_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_ISSUANCE_UKETS_WAIT_FOR_RDE_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_UKETS_WAIT_FOR_RFI_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_UKETS_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_ISSUANCE_UKETS_WAIT_FOR_RFI_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_CORSIA_CONFIRM_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_CORSIA_CONFIRM_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_VARIATION_CORSIA_CONFIRM_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_CORSIA_MAKE_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_CORSIA_MAKE_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_VARIATION_CORSIA_MAKE_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_CORSIA_RDE_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_CORSIA_RDE_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_VARIATION_CORSIA_RDE_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_CORSIA_RFI_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_CORSIA_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_VARIATION_CORSIA_RFI_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_CORSIA_TRACK_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_CORSIA_TRACK_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_VARIATION_CORSIA_TRACK_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_CORSIA_WAIT_FOR_RDE_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_CORSIA_WAIT_FOR_RDE_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_VARIATION_CORSIA_WAIT_FOR_RDE_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_CORSIA_WAIT_FOR_RFI_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_CORSIA_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_VARIATION_CORSIA_WAIT_FOR_RFI_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_UKETS_CONFIRM_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_UKETS_CONFIRM_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_VARIATION_UKETS_CONFIRM_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_UKETS_MAKE_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_UKETS_MAKE_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_VARIATION_UKETS_MAKE_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_UKETS_RDE_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_UKETS_RDE_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_VARIATION_UKETS_RDE_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_UKETS_RFI_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_UKETS_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_VARIATION_UKETS_RFI_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_UKETS_TRACK_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_UKETS_TRACK_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_VARIATION_UKETS_TRACK_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_UKETS_WAIT_FOR_RDE_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_UKETS_WAIT_FOR_RDE_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_VARIATION_UKETS_WAIT_FOR_RDE_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_UKETS_WAIT_FOR_RFI_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_UKETS_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'EMP_VARIATION_UKETS_WAIT_FOR_RFI_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_NER_CONFIRM_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'NER_CONFIRM_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'NER_CONFIRM_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_NER_MAKE_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'NER_MAKE_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'NER_MAKE_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_NER_TRACK_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'NER_TRACK_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'NER_TRACK_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_ISSUANCE_CONFIRM_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_ISSUANCE_CONFIRM_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_ISSUANCE_CONFIRM_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_ISSUANCE_MAKE_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_ISSUANCE_MAKE_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_ISSUANCE_MAKE_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_ISSUANCE_RDE_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_ISSUANCE_RDE_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_ISSUANCE_RDE_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_ISSUANCE_RFI_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_ISSUANCE_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_ISSUANCE_RFI_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_ISSUANCE_TRACK_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_ISSUANCE_TRACK_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_ISSUANCE_TRACK_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_ISSUANCE_WAIT_FOR_RDE_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_ISSUANCE_WAIT_FOR_RDE_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_ISSUANCE_WAIT_FOR_RDE_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_ISSUANCE_WAIT_FOR_RFI_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_ISSUANCE_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_ISSUANCE_WAIT_FOR_RFI_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_NOTIFICATION_RFI_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_NOTIFICATION_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_NOTIFICATION_RFI_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_NOTIFICATION_WAIT_FOR_RFI_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_NOTIFICATION_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_NOTIFICATION_WAIT_FOR_RFI_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_SURRENDER_CONFIRM_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_SURRENDER_CONFIRM_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_SURRENDER_CONFIRM_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_SURRENDER_MAKE_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_SURRENDER_MAKE_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_SURRENDER_MAKE_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_SURRENDER_RDE_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_SURRENDER_RDE_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_SURRENDER_RDE_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_SURRENDER_RFI_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_SURRENDER_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_SURRENDER_RFI_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_SURRENDER_TRACK_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_SURRENDER_TRACK_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_SURRENDER_TRACK_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_SURRENDER_WAIT_FOR_RDE_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_SURRENDER_WAIT_FOR_RDE_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_SURRENDER_WAIT_FOR_RDE_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_SURRENDER_WAIT_FOR_RFI_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_SURRENDER_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_SURRENDER_WAIT_FOR_RFI_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_TRANSFER_A_MAKE_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_TRANSFER_A_MAKE_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_TRANSFER_A_MAKE_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_TRANSFER_B_CONFIRM_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_TRANSFER_B_CONFIRM_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_TRANSFER_B_CONFIRM_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_TRANSFER_B_MAKE_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_TRANSFER_B_MAKE_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_TRANSFER_B_MAKE_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_TRANSFER_B_RDE_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_TRANSFER_B_RDE_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_TRANSFER_B_RDE_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_TRANSFER_B_RFI_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_TRANSFER_B_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_TRANSFER_B_RFI_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_TRANSFER_B_TRACK_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_TRANSFER_B_TRACK_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_TRANSFER_B_TRACK_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_TRANSFER_B_WAIT_FOR_RDE_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_TRANSFER_B_WAIT_FOR_RDE_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_TRANSFER_B_WAIT_FOR_RDE_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_TRANSFER_B_WAIT_FOR_RFI_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_TRANSFER_B_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_TRANSFER_B_WAIT_FOR_RFI_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_VARIATION_CONFIRM_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_VARIATION_CONFIRM_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_VARIATION_CONFIRM_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_VARIATION_MAKE_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_VARIATION_MAKE_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_VARIATION_MAKE_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_VARIATION_RDE_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_VARIATION_RDE_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_VARIATION_RDE_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_VARIATION_RFI_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_VARIATION_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_VARIATION_RFI_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_VARIATION_TRACK_PAYMENT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_VARIATION_TRACK_PAYMENT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_VARIATION_TRACK_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_VARIATION_WAIT_FOR_RDE_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_VARIATION_WAIT_FOR_RDE_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_VARIATION_WAIT_FOR_RDE_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_VARIATION_WAIT_FOR_RFI_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_VARIATION_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'PERMIT_VARIATION_WAIT_FOR_RFI_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_VIR_RFI_RESPONSE_SUBMIT" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'VIR_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'VIR_RFI_RESPONSE_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

	<changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_VIR_WAIT_FOR_RFI_RESPONSE" author="dridakisc@unisystems.gr">
    	<sql>
            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'VIR_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
    	</sql>
    	<rollback>
        	<sql>
                delete
                from au_service_rule
                where service_id in (select id
                from au_service
                where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
                and rule_id in (
                select id
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'VIR_WAIT_FOR_RFI_RESPONSE'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW');
        	</sql>
    	</rollback>
	</changeSet>

    <changeSet id="0_2_0_POPULATE_unappointVerificationBodyFromAccount_AUTHORIZATION_SERVICE" author="dridakisc@unisystems.gr">
        <comment>Populate appointVerificationBodyToAccount service</comment>
        <sql>
            insert into au_service(id, name)
            values (nextval('au_service_seq'), 'unappointVerificationBodyFromAccount');

            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name = 'unappointVerificationBodyFromAccount'
              and aur.resource_type = 'ACCOUNT'
              and aur.resource_sub_type is null
              and aur.handler = 'accountAccessHandler'
              and aur.scope = 'EDIT_USER'
              and aur.role_type = 'OPERATOR';
        </sql>
        <rollback>
            <sql>
                delete
                from au_service_rule
                where service_id = (select id from au_service where name = 'unappointVerificationBodyFromAccount');

                delete
                from au_service
                where name = 'unappointVerificationBodyFromAccount';
            </sql>
        </rollback>
    </changeSet>

    <changeSet id="0_2_0_add_rule_for_request_action_sub_type_DOAL_APPLICATION_PROCEEDED_TO_AUTHORITY_for_roles_OPERATOR" author="dridakisc@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'DOAL_APPLICATION_PROCEEDED_TO_AUTHORITY', 'requestActionViewHandler', 'OPERATOR');
        </sql>
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'DOAL_APPLICATION_PROCEEDED_TO_AUTHORITY'
              and r.handler = 'requestActionViewHandler'
              and r.role_type= 'OPERATOR'
              and r.scope is null;
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken')
                and r.resource_type = 'REQUEST_ACTION'
                and r.resource_sub_type = 'DOAL_APPLICATION_PROCEEDED_TO_AUTHORITY'
                and r.handler = 'requestActionViewHandler'
                and r.role_type = 'OPERATOR'
                and r.scope is null;

                delete
                from au_rule
                where resource_type = 'REQUEST_ACTION'
                and resource_sub_type = 'DOAL_APPLICATION_PROCEEDED_TO_AUTHORITY'
                and handler = 'requestActionViewHandler'
                and role_type = 'OPERATOR'
                and scope is null;
            </sql>
        </rollback>
    </changeSet>


    <changeSet id="0_2_0_add_rule_for_request_action_sub_type_DOAL_APPLICATION_CLOSED_for_roles_OPERATOR" author="dridakisc@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'DOAL_APPLICATION_CLOSED', 'requestActionViewHandler', 'OPERATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'DOAL_APPLICATION_CLOSED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'OPERATOR'
              and r.scope is null;
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
                and r.resource_type = 'REQUEST_ACTION'
                and r.resource_sub_type = 'DOAL_APPLICATION_CLOSED'
                and r.handler = 'requestActionViewHandler'
                and r.role_type = 'OPERATOR'
                and r.scope is null;

                delete from au_rule
                where resource_type = 'REQUEST_ACTION'
                and resource_sub_type = 'DOAL_APPLICATION_CLOSED'
                and handler = 'requestActionViewHandler'
                and role_type = 'OPERATOR'
                and scope is null;
            </sql>
        </rollback>
    </changeSet>

    <changeSet id="0_2_0_add_rule_for_request_action_sub_type_DOAL_APPLICATION_PROCEEDED_TO_AUTHORITY_for_roles_VERIFIER" author="dridakisc@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'DOAL_APPLICATION_PROCEEDED_TO_AUTHORITY', 'requestActionAccountBasedViewHandler', 'VERIFIER');
        </sql>
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'DOAL_APPLICATION_PROCEEDED_TO_AUTHORITY'
              and r.handler = 'requestActionAccountBasedViewHandler'
              and r.role_type= 'VERIFIER'
              and r.scope is null;
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken')
                and r.resource_type = 'REQUEST_ACTION'
                and r.resource_sub_type = 'DOAL_APPLICATION_PROCEEDED_TO_AUTHORITY'
                and r.handler = 'requestActionAccountBasedViewHandler'
                and r.role_type = 'VERIFIER'
                and r.scope is null;

                delete
                from au_rule
                where resource_type = 'REQUEST_ACTION'
                and resource_sub_type = 'DOAL_APPLICATION_PROCEEDED_TO_AUTHORITY'
                and handler = 'requestActionAccountBasedViewHandler'
                and role_type = 'VERIFIER'
                and scope is null;
            </sql>
        </rollback>
    </changeSet>


    <changeSet id="0_2_0_add_rule_for_request_action_sub_type_DOAL_APPLICATION_CLOSED_for_roles_VERIFIER" author="dridakisc@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'DOAL_APPLICATION_CLOSED', 'requestActionAccountBasedViewHandler', 'VERIFIER');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'DOAL_APPLICATION_CLOSED'
              and r.handler = 'requestActionAccountBasedViewHandler'
              and r.role_type = 'VERIFIER'
              and r.scope is null;
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
                and r.resource_type = 'REQUEST_ACTION'
                and r.resource_sub_type = 'DOAL_APPLICATION_CLOSED'
                and r.handler = 'requestActionAccountBasedViewHandler'
                and r.role_type = 'VERIFIER'
                and r.scope is null;

                delete from au_rule
                where resource_type = 'REQUEST_ACTION'
                and resource_sub_type = 'DOAL_APPLICATION_CLOSED'
                and handler = 'requestActionAccountBasedViewHandler'
                and role_type = 'VERIFIER'
                and scope is null;
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_create_au_service_rule_getDocumentPreview_AIR_application_review" author="AlekopoulosD@unisystems.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name = 'getDocumentPreview'
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AIR_APPLICATION_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'getDocumentPreview'
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'AIR_APPLICATION_REVIEW'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';
            </sql>
        </rollback>
    </changeSet>


    <changeSet id="0_2_0_create_au_service_rule_getDocumentPreview_DRE_application_review" author="kourisp@unisystems.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name = 'getDocumentPreview'
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'DRE_APPLICATION_SUBMIT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'getDocumentPreview'
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'DRE_APPLICATION_SUBMIT'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';
            </sql>
        </rollback>
    </changeSet>

    <changeSet id="0_2_0_create_au_service_rule_getDocumentPreview_Aviation_VIR_application_review" author="kourisp@unisystems.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name = 'getDocumentPreview'
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_VIR_APPLICATION_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'getDocumentPreview'
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'AVIATION_VIR_APPLICATION_REVIEW'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';
            </sql>
        </rollback>
    </changeSet>

    <!-- Rollback prev db changes jira: mets-6 -->
    <changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_AIR_RFI_RESPONSE_SUBMIT_ROLLBACK"
               author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'AIR_RFI_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'AIR_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>
        </rollback>
    </changeSet>

    <changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_AIR_WAIT_FOR_RFI_RESPONSE_ROLLBACK"
               author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'AIR_WAIT_FOR_RFI_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'AIR_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>
        </rollback>
    </changeSet>

    <changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_AVIATION_VIR_RFI_RESPONSE_SUBMIT_ROLLBACK"
               author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'AVIATION_VIR_RFI_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'AVIATION_VIR_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_AVIATION_VIR_WAIT_FOR_RFI_RESPONSE_ROLLBACK"
               author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'AVIATION_VIR_WAIT_FOR_RFI_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'AVIATION_VIR_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_CORSIA_RDE_RESPONSE_SUBMIT_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'EMP_ISSUANCE_CORSIA_RDE_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_CORSIA_RDE_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_CORSIA_RFI_RESPONSE_SUBMIT_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'EMP_ISSUANCE_CORSIA_RFI_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_CORSIA_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_CORSIA_WAIT_FOR_RDE_RESPONSE_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'EMP_ISSUANCE_CORSIA_WAIT_FOR_RDE_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_CORSIA_WAIT_FOR_RDE_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_CORSIA_WAIT_FOR_RFI_RESPONSE_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'EMP_ISSUANCE_CORSIA_WAIT_FOR_RFI_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_CORSIA_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_UKETS_RDE_RESPONSE_SUBMIT_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'EMP_ISSUANCE_UKETS_RDE_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_UKETS_RDE_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_UKETS_RFI_RESPONSE_SUBMIT_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'EMP_ISSUANCE_UKETS_RFI_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_UKETS_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_UKETS_WAIT_FOR_RDE_RESPONSE_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'EMP_ISSUANCE_UKETS_WAIT_FOR_RDE_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_UKETS_WAIT_FOR_RDE_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_ISSUANCE_UKETS_WAIT_FOR_RFI_RESPONSE_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'EMP_ISSUANCE_UKETS_WAIT_FOR_RFI_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_ISSUANCE_UKETS_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_CORSIA_RDE_RESPONSE_SUBMIT_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'EMP_VARIATION_CORSIA_RDE_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_CORSIA_RDE_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_CORSIA_RFI_RESPONSE_SUBMIT_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'EMP_VARIATION_CORSIA_RFI_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_CORSIA_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_CORSIA_WAIT_FOR_RDE_RESPONSE_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'EMP_VARIATION_CORSIA_WAIT_FOR_RDE_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_CORSIA_WAIT_FOR_RDE_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_CORSIA_WAIT_FOR_RFI_RESPONSE_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'EMP_VARIATION_CORSIA_WAIT_FOR_RFI_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_CORSIA_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_UKETS_RDE_RESPONSE_SUBMIT_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'EMP_VARIATION_UKETS_RDE_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_UKETS_RDE_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_UKETS_RFI_RESPONSE_SUBMIT_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'EMP_VARIATION_UKETS_RFI_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_UKETS_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_UKETS_WAIT_FOR_RDE_RESPONSE_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'EMP_VARIATION_UKETS_WAIT_FOR_RDE_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_UKETS_WAIT_FOR_RDE_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_EMP_VARIATION_UKETS_WAIT_FOR_RFI_RESPONSE_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'EMP_VARIATION_UKETS_WAIT_FOR_RFI_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'EMP_VARIATION_UKETS_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_ISSUANCE_RDE_RESPONSE_SUBMIT_ROLLBACK"
               author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'PERMIT_ISSUANCE_RDE_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_ISSUANCE_RDE_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_ISSUANCE_RFI_RESPONSE_SUBMIT_ROLLBACK"
               author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'PERMIT_ISSUANCE_RFI_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_ISSUANCE_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_ISSUANCE_WAIT_FOR_RDE_RESPONSE_ROLLBACK"
               author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'PERMIT_ISSUANCE_WAIT_FOR_RDE_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_ISSUANCE_WAIT_FOR_RDE_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_ISSUANCE_WAIT_FOR_RFI_RESPONSE_ROLLBACK"
               author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'PERMIT_ISSUANCE_WAIT_FOR_RFI_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_ISSUANCE_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_NOTIFICATION_RFI_RESPONSE_SUBMIT_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'PERMIT_NOTIFICATION_RFI_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_NOTIFICATION_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_NOTIFICATION_WAIT_FOR_RFI_RESPONSE_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'PERMIT_NOTIFICATION_WAIT_FOR_RFI_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_NOTIFICATION_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_SURRENDER_RDE_RESPONSE_SUBMIT_ROLLBACK"
               author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'PERMIT_SURRENDER_RDE_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_SURRENDER_RDE_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_SURRENDER_RFI_RESPONSE_SUBMIT_ROLLBACK"
               author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'PERMIT_SURRENDER_RFI_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_SURRENDER_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_SURRENDER_WAIT_FOR_RDE_RESPONSE_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'PERMIT_SURRENDER_WAIT_FOR_RDE_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_SURRENDER_WAIT_FOR_RDE_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_SURRENDER_WAIT_FOR_RFI_RESPONSE_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'PERMIT_SURRENDER_WAIT_FOR_RFI_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_SURRENDER_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_TRANSFER_B_RDE_RESPONSE_SUBMIT_ROLLBACK"
               author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'PERMIT_TRANSFER_B_RDE_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_TRANSFER_B_RDE_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_TRANSFER_B_RFI_RESPONSE_SUBMIT_ROLLBACK"
               author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'PERMIT_TRANSFER_B_RFI_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_TRANSFER_B_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_TRANSFER_B_WAIT_FOR_RDE_RESPONSE_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'PERMIT_TRANSFER_B_WAIT_FOR_RDE_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_TRANSFER_B_WAIT_FOR_RDE_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_TRANSFER_B_WAIT_FOR_RFI_RESPONSE_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'PERMIT_TRANSFER_B_WAIT_FOR_RFI_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_TRANSFER_B_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_VARIATION_RDE_RESPONSE_SUBMIT_ROLLBACK"
               author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'PERMIT_VARIATION_RDE_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_VARIATION_RDE_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_VARIATION_RFI_RESPONSE_SUBMIT_ROLLBACK"
               author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'PERMIT_VARIATION_RFI_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_VARIATION_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_VARIATION_WAIT_FOR_RDE_RESPONSE_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'PERMIT_VARIATION_WAIT_FOR_RDE_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_VARIATION_WAIT_FOR_RDE_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet
            id="0_2_0_insert_auth_data_for_reassign_request_task_type_PERMIT_VARIATION_WAIT_FOR_RFI_RESPONSE_ROLLBACK"
            author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'PERMIT_VARIATION_WAIT_FOR_RFI_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'PERMIT_VARIATION_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_VIR_RFI_RESPONSE_SUBMIT_ROLLBACK"
               author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'VIR_RFI_RESPONSE_SUBMIT'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'OPERATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'VIR_RFI_RESPONSE_SUBMIT' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'OPERATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet id="0_2_0_insert_auth_data_for_reassign_request_task_type_VIR_WAIT_FOR_RFI_RESPONSE_ROLLBACK"
               author="kourisp@unisystems.eu">
        <sql>
            delete
            from au_service_rule
            where service_id in (select id
                                 from au_service
                                 where name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask'))
              and rule_id in (select id
                              from au_rule
                              where resource_type = 'REQUEST_TASK'
                                and resource_sub_type = 'VIR_WAIT_FOR_RFI_RESPONSE'
                                and handler = 'requestTaskAccessHandler'
                                and role_type = 'REGULATOR'
                                and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select aus.id, aur.id
                from au_service aus
                cross join au_rule aur
                where aus.name in ('getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask') and
                aur.resource_type = 'REQUEST_TASK' and
                aur.resource_sub_type = 'VIR_WAIT_FOR_RFI_RESPONSE' and
                aur.handler = 'requestTaskAccessHandler' and
                aur.role_type = 'REGULATOR' and
                aur.scope = 'REQUEST_TASK_VIEW';
            </sql>

        </rollback>
    </changeSet>

    <changeSet id="0_2_0_create_au_service_rule_getDocumentPreview_Permit_transfer_review" author="AlekopoulosD@unisystems.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name = 'getDocumentPreview'
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'PERMIT_TRANSFER_B_APPLICATION_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'getDocumentPreview'
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'PERMIT_TRANSFER_B_APPLICATION_REVIEW'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_create_au_service_rule_getDocumentPreview_Permit_variation_application_peer_review" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
            cross join au_rule r
            where s.name = 'getDocumentPreview'
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'PERMIT_VARIATION_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'getDocumentPreview'
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'PERMIT_VARIATION_APPLICATION_PEER_REVIEW'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';
            </sql>
        </rollback>
    </changeSet>

    <changeSet id="0_2_0_create_au_service_rule_getDocumentPreview_Dre_application_peer_review" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
            cross join au_rule r
            where s.name = 'getDocumentPreview'
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'DRE_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';

        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'getDocumentPreview'
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'DRE_APPLICATION_PEER_REVIEW'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';
            </sql>
        </rollback>
    </changeSet>

    <changeSet id="0_2_0_create_au_service_rule_getDocumentPreview_Permit_issuance_peer_review" author="AlekopoulosD@unisystems.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name = 'getDocumentPreview'
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'PERMIT_ISSUANCE_APPLICATION_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'getDocumentPreview'
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'PERMIT_ISSUANCE_APPLICATION_PEER_REVIEW'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';
            </sql>
        </rollback>
    </changeSet>

    <changeSet id="0_2_0_au_rule_account_installation_onsite_inspection_request_create_regulator" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'ACCOUNT', 'INSTALLATION_ONSITE_INSPECTION', 'accountRequestCreateHandler', 'REGULATOR', 'REQUEST_CREATE');
        </sql>
        <rollback>
            <sql>
                delete
                from au_rule
                where resource_type = 'ACCOUNT'
                and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION'
                and handler = 'accountRequestCreateHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_CREATE';
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_service_rule_account_installation_onsite_inspection_request_create_regulator" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
            cross join au_rule r
            where s.name = 'processRequestCreateAction'
            and r.resource_type = 'ACCOUNT'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION'
            and r.handler = 'accountRequestCreateHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_CREATE';
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'processRequestCreateAction'
                and r.resource_type = 'ACCOUNT'
                and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION'
                and r.handler = 'accountRequestCreateHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_CREATE';
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_rule_account_installation_audit_request_create_regulator" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'ACCOUNT', 'INSTALLATION_AUDIT', 'accountRequestCreateHandler', 'REGULATOR', 'REQUEST_CREATE');
        </sql>
        <rollback>
            <sql>
                delete
                from au_rule
                where resource_type = 'ACCOUNT'
                and resource_sub_type = 'INSTALLATION_AUDIT'
                and handler = 'accountRequestCreateHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_CREATE';
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_service_rule_account_installation_audit_request_create_regulator" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
            cross join au_rule r
            where s.name = 'processRequestCreateAction'
            and r.resource_type = 'ACCOUNT'
            and r.resource_sub_type = 'INSTALLATION_AUDIT'
            and r.handler = 'accountRequestCreateHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_CREATE';
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'processRequestCreateAction'
                and r.resource_type = 'ACCOUNT'
                and r.resource_sub_type = 'INSTALLATION_AUDIT'
                and r.handler = 'accountRequestCreateHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_CREATE';
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_create_au_service_rule_getDocumentPreview_Emp_issuance_ukets_application_peer_review" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
            cross join au_rule r
            where s.name = 'getDocumentPreview'
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'EMP_ISSUANCE_UKETS_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'getDocumentPreview'
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'EMP_ISSUANCE_UKETS_APPLICATION_PEER_REVIEW'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_create_au_service_rule_getDocumentPreview_Emp_issuance_corsia_application_peer_review" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
            cross join au_rule r
            where s.name = 'getDocumentPreview'
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'EMP_ISSUANCE_CORSIA_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'getDocumentPreview'
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'EMP_ISSUANCE_CORSIA_APPLICATION_PEER_REVIEW'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_resource_scope_permission_account_installation_audit_request_create_regulator" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'ACCOUNT',
            'INSTALLATION_AUDIT',
            'REQUEST_CREATE',
            'PERM_INSTALLATION_AUDIT_APPLICATION_SUBMIT_EXECUTE_TASK',
            'REGULATOR');
        </sql>
        <rollback>
            <sql>
               delete from au_resource_scope_permission
               where resource_type = 'ACCOUNT'
               and resource_sub_type = 'INSTALLATION_AUDIT'
               and scope = 'REQUEST_CREATE'
               and permission = 'PERM_INSTALLATION_AUDIT_APPLICATION_SUBMIT_EXECUTE_TASK'
               and role_type = 'REGULATOR';
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_rule_request_task_installation_audit_application_submit_request_task_view_regulator" author="dimitrios.topalidis@trasys.gr">
        <sql>
          insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
          values (nextval('au_rule_seq'), 'REQUEST_TASK', 'INSTALLATION_AUDIT_APPLICATION_SUBMIT', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
          <sql>
              delete
              from au_rule
              where resource_type = 'REQUEST_TASK'
              and resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMIT'
              and handler = 'requestTaskAccessHandler'
              and role_type = 'REGULATOR'
              and scope = 'REQUEST_TASK_VIEW';
          </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_service_rule_request_task_installation_audit_application_submit_request_task_view_regulator" author="dimitrios.topalidis@trasys.gr">
        <sql>
          insert into au_service_rule(service_id, rule_id)
          select s.id, r.id
          from au_service s
          cross join au_rule r
          where s.name in ('assignTask', 'getCandidateAssigneesByTaskId', 'releaseTask', 'getTaskItemInfoById', 'generateRequestTaskGetFileAttachmentToken')
          and r.resource_type = 'REQUEST_TASK'
          and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMIT'
          and r.handler = 'requestTaskAccessHandler'
          and r.role_type = 'REGULATOR'
          and r.scope = 'REQUEST_TASK_VIEW';
        </sql>
        <rollback>
          <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('assignTask', 'getCandidateAssigneesByTaskId', 'releaseTask', 'getTaskItemInfoById', 'generateRequestTaskGetFileAttachmentToken')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMIT'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_VIEW';
          </sql>
        </rollback>
    </changeSet>

    <changeSet id="0_2_0_au_resource_scope_permission_request_task_installation_audit_application_submit_request_task_view_regulator" author="dimitrios.topalidis@trasys.gr">
         <sql>
             insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
             (select nextval('au_resource_scope_permission_seq'),
             'REQUEST_TASK',
             'INSTALLATION_AUDIT_APPLICATION_SUBMIT',
             'REQUEST_TASK_VIEW',
             'PERM_INSTALLATION_AUDIT_APPLICATION_SUBMIT_VIEW_TASK',
             'REGULATOR');
         </sql>
        <rollback>
             <sql>
                    delete from au_resource_scope_permission
                    where resource_type = 'REQUEST_TASK'
                    and resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMIT'
                    and scope = 'REQUEST_TASK_VIEW'
                    and permission = 'PERM_INSTALLATION_AUDIT_APPLICATION_SUBMIT_VIEW_TASK'
                    and role_type = 'REGULATOR';
             </sql>
     </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_rule_request_task_installation_audit_application_submit_request_task_execute_regulator" author="dimitrios.topalidis@trasys.gr">
        <sql>
           insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
           values (nextval('au_rule_seq'), 'REQUEST_TASK', 'INSTALLATION_AUDIT_APPLICATION_SUBMIT', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');
        </sql>
        <rollback>
               <sql>
                   delete
                   from au_rule
                   where resource_type = 'REQUEST_TASK'
                   and resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMIT'
                   and handler = 'requestTaskAccessHandler'
                   and role_type = 'REGULATOR'
                   and scope = 'REQUEST_TASK_EXECUTE';
               </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_service_rule_request_task_installation_audit_application_submit_request_task_execute_regulator_for_processRequestTaskAction" author="dimitrios.topalidis@trasys.gr">
        <sql>
           insert into au_service_rule(service_id, rule_id)
           select s.id, r.id
           from au_service s
           cross join au_rule r
           where s.name in ('processRequestTaskAction')
           and r.resource_type = 'REQUEST_TASK'
           and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMIT'
           and r.handler = 'requestTaskAccessHandler'
           and r.role_type = 'REGULATOR'
           and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
           <sql>
                 delete from au_service_rule sr
                 using
                 au_rule r,
                 au_service s
                 where r.id = sr.rule_id
                 and s.id = sr.service_id
                 and s.name in ('processRequestTaskAction')
                 and r.resource_type = 'REQUEST_TASK'
                 and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMIT'
                 and r.handler = 'requestTaskAccessHandler'
                 and r.role_type = 'REGULATOR'
                 and r.scope = 'REQUEST_TASK_EXECUTE';
           </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_service_rule_request_task_installation_audit_application_submit_request_task_execute_regulator_for_uploadRequestTaskAttachment" author="dimitrios.topalidis@trasys.gr">
        <sql>
           insert into au_service_rule(service_id, rule_id)
           select s.id, r.id
           from au_service s
           cross join au_rule r
           where s.name in ('uploadRequestTaskAttachment')
           and r.resource_type = 'REQUEST_TASK'
           and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMIT'
           and r.handler = 'requestTaskAccessHandler'
           and r.role_type = 'REGULATOR'
           and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
           <sql>
                 delete from au_service_rule sr
                 using
                 au_rule r,
                 au_service s
                 where r.id = sr.rule_id
                 and s.id = sr.service_id
                 and s.name in ('uploadRequestTaskAttachment')
                 and r.resource_type = 'REQUEST_TASK'
                 and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMIT'
                 and r.handler = 'requestTaskAccessHandler'
                 and r.role_type = 'REGULATOR'
                 and r.scope = 'REQUEST_TASK_EXECUTE';
           </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_resource_scope_permission_request_task_installation_audit_application_submit_request_task_execute_perm_installation_audit_application_submit_execute_task_regulator" author="dimitrios.topalidis@trasys.gr">
        <sql>
          insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
          (select nextval('au_resource_scope_permission_seq'),
          'REQUEST_TASK',
          'INSTALLATION_AUDIT_APPLICATION_SUBMIT',
          'REQUEST_TASK_EXECUTE',
          'PERM_INSTALLATION_AUDIT_APPLICATION_SUBMIT_EXECUTE_TASK',
          'REGULATOR');
        </sql>
        <rollback>
            <sql>
                  delete from au_resource_scope_permission
                     where resource_type = 'REQUEST_TASK'
                     and resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMIT'
                     and scope = 'REQUEST_TASK_EXECUTE'
                     and permission = 'PERM_INSTALLATION_AUDIT_APPLICATION_SUBMIT_EXECUTE_TASK'
                     and role_type = 'REGULATOR';
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_resource_scope_permission_account_installation_onsite_inspection_request_create_regulator" author="alekopoulosd@unisystems.gr">
            <sql>
                insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                    (select nextval('au_resource_scope_permission_seq'),
                            'ACCOUNT',
                            'INSTALLATION_ONSITE_INSPECTION',
                            'REQUEST_CREATE',
                            'PERM_INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT_EXECUTE_TASK',
                            'REGULATOR');
            </sql>
            <rollback>
                <sql>
                    delete from au_resource_scope_permission
                    where resource_type = 'ACCOUNT'
                    and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION'
                    and scope = 'REQUEST_CREATE'
                    and permission = 'PERM_INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT_EXECUTE_TASK'
                    and role_type = 'REGULATOR';
                </sql>
            </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_rule_request_task_installation_onsite_inspection_application_submit_request_task_view_regulator" author="alekopoulosd@unisystems.gr">
            <sql>
                insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
                values (nextval('au_rule_seq'), 'REQUEST_TASK', 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');
            </sql>
            <rollback>
                <sql>
                    delete
                    from au_rule
                    where resource_type = 'REQUEST_TASK'
                    and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT'
                    and handler = 'requestTaskAccessHandler'
                    and role_type = 'REGULATOR'
                    and scope = 'REQUEST_TASK_VIEW';
                </sql>
            </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_service_rule_request_task_installation_installation_onsite_application_submit_request_task_view_regulator" author="alekopoulosd@unisystems.gr">
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select s.id, r.id
                from au_service s
                         cross join au_rule r
                where s.name in ('assignTask', 'getCandidateAssigneesByTaskId', 'releaseTask', 'getTaskItemInfoById', 'generateRequestTaskGetFileAttachmentToken')
                  and r.resource_type = 'REQUEST_TASK'
                  and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT'
                  and r.handler = 'requestTaskAccessHandler'
                  and r.role_type = 'REGULATOR'
                  and r.scope = 'REQUEST_TASK_VIEW';
            </sql>
            <rollback>
                <sql>
                    delete from au_service_rule sr
                    using
                    au_rule r,
                    au_service s
                    where r.id = sr.rule_id
                    and s.id = sr.service_id
                    and s.name in ('assignTask', 'getCandidateAssigneesByTaskId', 'releaseTask', 'getTaskItemInfoById', 'generateRequestTaskGetFileAttachmentToken')
                    and r.resource_type = 'REQUEST_TASK'
                    and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT'
                    and r.handler = 'requestTaskAccessHandler'
                    and r.role_type = 'REGULATOR'
                    and r.scope = 'REQUEST_TASK_VIEW';
                </sql>
            </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_resource_scope_permission_request_task_installation_onsite_inspection_application_submit_request_task_view_regulator" author="alekopoulosd@unisystems.gr">
            <sql>
                insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                    (select nextval('au_resource_scope_permission_seq'),
                            'REQUEST_TASK',
                            'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT',
                            'REQUEST_TASK_VIEW',
                            'PERM_INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT_VIEW_TASK',
                            'REGULATOR');
            </sql>
            <rollback>
                <sql>
                    delete from au_resource_scope_permission
                    where resource_type = 'REQUEST_TASK'
                    and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT'
                    and scope = 'REQUEST_TASK_VIEW'
                    and permission = 'PERM_INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT_VIEW_TASK'
                    and role_type = 'REGULATOR';
                </sql>
            </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_rule_request_task_installation_onsite_inspection_application_submit_request_task_execute_regulator" author="alekopoulosd@unisystems.gr">
            <sql>
                insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
                values (nextval('au_rule_seq'), 'REQUEST_TASK', 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');
            </sql>
            <rollback>
                <sql>
                    delete
                    from au_rule
                    where resource_type = 'REQUEST_TASK'
                    and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT'
                    and handler = 'requestTaskAccessHandler'
                    and role_type = 'REGULATOR'
                    and scope = 'REQUEST_TASK_EXECUTE';
                </sql>
            </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_service_rule_request_task_installation_onsite_inspection_application_submit_request_task_execute_regulator_for_processRequestTaskAction" author="alekopoulosd@unisystems.gr">
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select s.id, r.id
                from au_service s
                         cross join au_rule r
                where s.name in ('processRequestTaskAction')
                  and r.resource_type = 'REQUEST_TASK'
                  and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT'
                  and r.handler = 'requestTaskAccessHandler'
                  and r.role_type = 'REGULATOR'
                  and r.scope = 'REQUEST_TASK_EXECUTE';
            </sql>
            <rollback>
                <sql>
                    delete from au_service_rule sr
                    using
                    au_rule r,
                    au_service s
                    where r.id = sr.rule_id
                    and s.id = sr.service_id
                    and s.name in ('processRequestTaskAction')
                    and r.resource_type = 'REQUEST_TASK'
                    and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT'
                    and r.handler = 'requestTaskAccessHandler'
                    and r.role_type = 'REGULATOR'
                    and r.scope = 'REQUEST_TASK_EXECUTE';
                </sql>
            </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_service_rule_request_task_installation_onsite_inspection_application_submit_request_task_execute_regulator_for_uploadRequestTaskAttachment" author="alekopoulosd@unisystems.gr">
            <sql>
                insert into au_service_rule(service_id, rule_id)
                select s.id, r.id
                from au_service s
                         cross join au_rule r
                where s.name in ('uploadRequestTaskAttachment')
                  and r.resource_type = 'REQUEST_TASK'
                  and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT'
                  and r.handler = 'requestTaskAccessHandler'
                  and r.role_type = 'REGULATOR'
                  and r.scope = 'REQUEST_TASK_EXECUTE';
            </sql>
            <rollback>
                <sql>
                    delete from au_service_rule sr
                    using
                    au_rule r,
                    au_service s
                    where r.id = sr.rule_id
                    and s.id = sr.service_id
                    and s.name in ('uploadRequestTaskAttachment')
                    and r.resource_type = 'REQUEST_TASK'
                    and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT'
                    and r.handler = 'requestTaskAccessHandler'
                    and r.role_type = 'REGULATOR'
                    and r.scope = 'REQUEST_TASK_EXECUTE';
                </sql>
            </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_resource_scope_permission_request_task_installation_onsite_inspection_application_submit_request_task_execute_perm_installation_onsite_inspection_application_submit_execute_task_regulator" author="dimitrios.topalidis@trasys.gr">
            <sql>
                insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                    (select nextval('au_resource_scope_permission_seq'),
                            'REQUEST_TASK',
                            'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT',
                            'REQUEST_TASK_EXECUTE',
                            'PERM_INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT_EXECUTE_TASK',
                            'REGULATOR');
            </sql>
            <rollback>
                <sql>
                    delete from au_resource_scope_permission
                    where resource_type = 'REQUEST_TASK'
                    and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT'
                    and scope = 'REQUEST_TASK_EXECUTE'
                    and permission = 'PERM_INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT_EXECUTE_TASK'
                    and role_type = 'REGULATOR';
                </sql>
            </rollback>
    </changeSet>

    <changeSet id="0_2_0_create_au_service_rule_getDocumentPreview_Permit_surrender_peer_review" author="AlekopoulosD@unisystems.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name = 'getDocumentPreview'
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'PERMIT_SURRENDER_APPLICATION_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'getDocumentPreview'
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'PERMIT_SURRENDER_APPLICATION_PEER_REVIEW'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';
            </sql>
        </rollback>
    </changeSet>


    <changeSet id="0_2_0_au_installation_audit_peer_review_authorization_rules" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('processRequestTaskAction')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW',
                        'REQUEST_TASK_VIEW',
                        'PERM_INSTALLATION_AUDIT_PEER_REVIEW_VIEW_TASK',
                        'REGULATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_INSTALLATION_AUDIT_PEER_REVIEW_EXECUTE_TASK',
                        'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'INSTALLATION_AUDIT_WAIT_FOR_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('processRequestTaskAction')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_WAIT_FOR_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'INSTALLATION_AUDIT_WAIT_FOR_PEER_REVIEW',
                        'REQUEST_TASK_VIEW',
                        'PERM_INSTALLATION_AUDIT_APPLICATION_SUBMIT_VIEW_TASK',
                        'REGULATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'INSTALLATION_AUDIT_WAIT_FOR_PEER_REVIEW',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_INSTALLATION_AUDIT_APPLICATION_SUBMIT_EXECUTE_TASK',
                        'REGULATOR');
        </sql>
        <rollback>
            <sql>
                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
                and scope = 'REQUEST_TASK_VIEW'
                and permission = 'PERM_INSTALLATION_AUDIT_PEER_REVIEW_VIEW_TASK'
                and role_type = 'REGULATOR';

                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
                and scope = 'REQUEST_TASK_EXECUTE'
                and permission = 'PERM_INSTALLATION_AUDIT_PEER_REVIEW_EXECUTE_TASK'
                and role_type = 'REGULATOR';

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('processRequestTaskAction')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_VIEW';

                delete
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW';




                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_AUDIT_WAIT_FOR_PEER_REVIEW'
                and scope = 'REQUEST_TASK_VIEW'
                and permission = 'PERM_INSTALLATION_AUDIT_APPLICATION_SUBMIT_VIEW_TASK'
                and role_type = 'REGULATOR';

                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_AUDIT_WAIT_FOR_PEER_REVIEW'
                and scope = 'REQUEST_TASK_EXECUTE'
                and permission = 'PERM_INSTALLATION_AUDIT_APPLICATION_SUBMIT_EXECUTE_TASK'
                and role_type = 'REGULATOR';

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('processRequestTaskAction')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'INSTALLATION_AUDIT_WAIT_FOR_PEER_REVIEW'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_VIEW';

                delete
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_AUDIT_WAIT_FOR_PEER_REVIEW'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW';
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_installation_onsite_inspection_peer_review_authorization_rules" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('processRequestTaskAction')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW',
                        'REQUEST_TASK_VIEW',
                        'PERM_INSTALLATION_ONSITE_INSPECTION_PEER_REVIEW_VIEW_TASK',
                        'REGULATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_INSTALLATION_ONSITE_INSPECTION_PEER_REVIEW_EXECUTE_TASK',
                        'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'INSTALLATION_ONSITE_INSPECTION_WAIT_FOR_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('processRequestTaskAction')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_WAIT_FOR_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'INSTALLATION_ONSITE_INSPECTION_WAIT_FOR_PEER_REVIEW',
                        'REQUEST_TASK_VIEW',
                        'PERM_INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT_VIEW_TASK',
                        'REGULATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'INSTALLATION_ONSITE_INSPECTION_WAIT_FOR_PEER_REVIEW',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT_EXECUTE_TASK',
                        'REGULATOR');
        </sql>
        <rollback>
            <sql>
                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
                and scope = 'REQUEST_TASK_VIEW'
                and permission = 'PERM_INSTALLATION_ONSITE_INSPECTION_PEER_REVIEW_VIEW_TASK'
                and role_type = 'REGULATOR';

                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
                and scope = 'REQUEST_TASK_EXECUTE'
                and permission = 'PERM_INSTALLATION_ONSITE_INSPECTION_PEER_REVIEW_EXECUTE_TASK'
                and role_type = 'REGULATOR';

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('processRequestTaskAction')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_VIEW';

                delete
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW';




                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_WAIT_FOR_PEER_REVIEW'
                and scope = 'REQUEST_TASK_VIEW'
                and permission = 'PERM_INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT_VIEW_TASK'
                and role_type = 'REGULATOR';

                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_WAIT_FOR_PEER_REVIEW'
                and scope = 'REQUEST_TASK_EXECUTE'
                and permission = 'PERM_INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT_EXECUTE_TASK'
                and role_type = 'REGULATOR';

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('processRequestTaskAction')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_WAIT_FOR_PEER_REVIEW'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_VIEW';

                delete
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_WAIT_FOR_PEER_REVIEW'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW';
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_installation_onsite_inspection_peer_review_authorization_rules_getCandidateAssigneesByTaskType" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getCandidateAssigneesByTaskType')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getCandidateAssigneesByTaskType')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_installation_audit_peer_review_authorization_rules_getCandidateAssigneesByTaskType" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getCandidateAssigneesByTaskType')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getCandidateAssigneesByTaskType')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_installation_onsite_inspection_peer_review_authorization_rules_getTaskItemInfoById" author="dimitrios.topalidis@trasys.gr">
        <sql>
       insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getTaskItemInfoById')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_WAIT_FOR_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getTaskItemInfoById')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getTaskItemInfoById')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_WAIT_FOR_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

               delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getTaskItemInfoById')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_installation_audit_peer_review_authorization_rules_getTaskItemInfoById" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getTaskItemInfoById')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_WAIT_FOR_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getTaskItemInfoById')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getTaskItemInfoById')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_WAIT_FOR_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

               delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getTaskItemInfoById')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_installation_inspction_request_action_authorization_rules" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEW_REQUESTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEWER_ACCEPTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEWER_REJECTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_INSPECTION_APPLICATION_SUBMITTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_INSPECTION_APPLICATION_CANCELLED', 'requestActionViewHandler', 'REGULATOR');
        </sql>
        <rollback>
            <sql>
                delete
                from au_rule
                where resource_type = 'REQUEST_ACTION'
                and resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEW_REQUESTED'
                and handler = 'requestActionViewHandler'
                and role_type = 'REGULATOR'
                and scope is null;

                delete
                from au_rule
                where resource_type = 'REQUEST_ACTION'
                and resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEWER_ACCEPTED'
                and handler = 'requestActionViewHandler'
                and role_type = 'REGULATOR'
                and scope is null;


                delete
                from au_rule
                where resource_type = 'REQUEST_ACTION'
                and resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEWER_REJECTED'
                and handler = 'requestActionViewHandler'
                and role_type = 'REGULATOR'
                and scope is null;


                delete
                from au_rule
                where resource_type = 'REQUEST_ACTION'
                and resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_SUBMITTED'
                and handler = 'requestActionViewHandler'
                and role_type = 'REGULATOR'
                and scope is null;


                delete
                from au_rule
                where resource_type = 'REQUEST_ACTION'
                and resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_CANCELLED'
                and handler = 'requestActionViewHandler'
                and role_type = 'REGULATOR'
                and scope is null;
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_installation_inspection_peer_review_authorization_rules_getRequestActionById" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEW_REQUESTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEWER_ACCEPTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEWER_REJECTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_CANCELLED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEW_REQUESTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEWER_ACCEPTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEWER_REJECTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;


            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_CANCELLED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_installation_inspection_peer_review_authorization_rules_getCandidateAssigneesByTaskId_assignTask" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
              cross join au_rule r
            where s.name in ('getCandidateAssigneesByTaskId','assignTask')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
              cross join au_rule r
            where s.name in ('getCandidateAssigneesByTaskId','assignTask')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getCandidateAssigneesByTaskId','assignTask')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getCandidateAssigneesByTaskId','assignTask')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_installation_inspection_peer_review_authorization_rules_releaseTask" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
              cross join au_rule r
            where s.name in ('releaseTask')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
              cross join au_rule r
            where s.name in ('releaseTask')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('releaseTask')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('releaseTask')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_installation_inspection_application_submit_authorization_rules_getDocumentPreview" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
               cross join au_rule r
            where s.name in ('getDocumentPreview')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
               cross join au_rule r
            where s.name in ('getDocumentPreview')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getDocumentPreview')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getDocumentPreview')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_rules_insert_for_aer_mark_as_not_required" author="kourisp@unisystems.eu">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AER_APPLICATION_NOT_REQUIRED',
                    'requestActionViewHandler', 'OPERATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AER_APPLICATION_NOT_REQUIRED',
                    'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AER_APPLICATION_NOT_REQUIRED',
                    'requestActionAccountBasedViewHandler', 'VERIFIER');

        </sql>
        <rollback>

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AER_APPLICATION_NOT_REQUIRED'
            and handler = 'requestActionAccountBasedViewHandler'
            and role_type = 'VERIFIER'
            and scope is null;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AER_APPLICATION_NOT_REQUIRED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope is null;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AER_APPLICATION_NOT_REQUIRED'
            and handler = 'requestActionViewHandler'
            and role_type = 'OPERATOR'
            and scope is null;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_services_insert_for_aer_mark_as_not_required" author="kourisp@unisystems.eu">
        <sql>
            insert into au_service(id, name)
            values (nextval('au_service_seq'), 'markAsNotRequired');

            insert into au_service(id, name)
            values (nextval('au_service_seq'), 'hasAccessMarkAsNotRequired');
        </sql>
        <rollback>

            delete from au_service aus where aus.name = 'hasAccessMarkAsNotRequired';
            delete from au_service aus where aus.name = 'markAsNotRequired';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_services_rules_insert_for_aer_mark_as_not_required" author="kourisp@unisystems.eu">
        <sql>

            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_rule aur
                     cross join public.au_service aus
            where aus.name in ('markAsNotRequired', 'hasAccessMarkAsNotRequired')
              and aur.resource_type = 'REQUEST'
              and aur.handler = 'requestAccessHandler'
              and aur.scope is null
              and aur.role_type = 'REGULATOR';

        </sql>
        <rollback>

            delete from au_service_rule sr where service_id in (
            select id
            from au_service
            where name in ('markAsNotRequired', 'hasAccessMarkAsNotRequired')
            ) and
            sr.rule_id in (
            select id
            from au_rule r
            where r.resource_type = 'REQUEST'
            and r.handler = 'requestAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL
            )


        </rollback>
    </changeSet>

    <changeSet id="0_2_0_au_services_rules_insert_for_getRequestActionById" author="kourisp@unisystems.eu">
        <sql>

            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_rule aur
                     cross join au_service aus
            where
                aus.name in ('getRequestActionById')
              and resource_type = 'REQUEST_ACTION'
              and resource_sub_type = 'AER_APPLICATION_NOT_REQUIRED'
              and aur.handler = 'requestActionViewHandler'
              and scope is null
              and role_type = 'REGULATOR';

            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_rule aur
                     cross join au_service aus
            where
                aus.name in ('getRequestActionById')
              and resource_type = 'REQUEST_ACTION'
              and resource_sub_type = 'AER_APPLICATION_NOT_REQUIRED'
              and aur.handler = 'requestActionViewHandler'
              and scope is null
              and role_type = 'OPERATOR';

            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_rule aur
                     cross join au_service aus
            where
                aus.name in ('getRequestActionById')
              and resource_type = 'REQUEST_ACTION'
              and resource_sub_type = 'AER_APPLICATION_NOT_REQUIRED'
              and aur.handler = 'requestActionAccountBasedViewHandler'
              and scope is null
              and role_type = 'VERIFIER';

        </sql>
        <rollback>

            delete
            from au_service_rule sr
            where service_id in (select id
            from au_service
            where name in ('getRequestActionById'))
            and sr.rule_id in (select id
            from au_rule r
            where
            resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AER_APPLICATION_NOT_REQUIRED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL)
            ;


            delete
            from au_service_rule sr
            where service_id in (select id
            from au_service
            where name in ('getRequestActionById'))
            and sr.rule_id in (select id
            from au_rule r
            where
            resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AER_APPLICATION_NOT_REQUIRED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL)
            ;

            delete
            from au_service_rule sr
            where service_id in (select id
            from au_service
            where name in ('getRequestActionById'))
            and sr.rule_id in (select id
            from au_rule r
            where
            resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AER_APPLICATION_NOT_REQUIRED'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL)
            ;

        </rollback>
    </changeSet>

    <changeSet id="0_2_0__installation_inspection_operator_respond_request_action_authorization_rules" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPONDED', 'requestActionViewHandler', 'OPERATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_AUDIT_OPERATOR_RESPONDED', 'requestActionViewHandler', 'OPERATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPONDED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPONDED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPONDED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPONDED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPONDED'
            and handler = 'requestActionViewHandler'
            and role_type = 'OPERATOR'
            and scope is null;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPONDED'
            and handler = 'requestActionViewHandler'
            and role_type = 'OPERATOR'
            and scope is null;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0__installation_onsite_inspection_operator_respond_authorization_rules" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
               values (nextval('au_rule_seq'), 'REQUEST_TASK', 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS', 'requestTaskAccessHandler', 'OPERATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS', 'requestTaskAccessHandler', 'OPERATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_service_rule(service_id, rule_id)
              select s.id, r.id
              from au_service s
                       cross join au_rule r
            where s.name in ('getTaskItemInfoById')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('processRequestTaskAction')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'OPERATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
                   'REQUEST_TASK',
                   'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS',
                   'REQUEST_TASK_VIEW',
                   'PERM_INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS_VIEW_TASK',
                   'OPERATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
               'REQUEST_TASK',
               'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS',
               'REQUEST_TASK_EXECUTE',
               'PERM_INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS_EXECUTE_TASK',
               'OPERATOR');
        </sql>
        <rollback>
                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
                and scope = 'REQUEST_TASK_VIEW'
                and permission = 'PERM_INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS_VIEW_TASK'
                and role_type = 'OPERATOR';

                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
                and scope = 'REQUEST_TASK_EXECUTE'
                and permission = 'PERM_INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS_EXECUTE_TASK'
                and role_type = 'OPERATOR';

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('processRequestTaskAction')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'OPERATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('getTaskItemInfoById')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'OPERATOR'
                and r.scope = 'REQUEST_TASK_VIEW';

                delete
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_EXECUTE';


                delete
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_installation_audit_operator_respond_authorization_rules" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
               values (nextval('au_rule_seq'), 'REQUEST_TASK', 'INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS', 'requestTaskAccessHandler', 'OPERATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS', 'requestTaskAccessHandler', 'OPERATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_service_rule(service_id, rule_id)
              select s.id, r.id
              from au_service s
                       cross join au_rule r
            where s.name in ('getTaskItemInfoById')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('processRequestTaskAction')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'OPERATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
                   'REQUEST_TASK',
                   'INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS',
                   'REQUEST_TASK_VIEW',
                   'PERM_INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS_VIEW_TASK',
                   'OPERATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
               'REQUEST_TASK',
               'INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS',
               'REQUEST_TASK_EXECUTE',
               'PERM_INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS_EXECUTE_TASK',
               'OPERATOR');
        </sql>
        <rollback>
                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
                and scope = 'REQUEST_TASK_VIEW'
                and permission = 'PERM_INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS_VIEW_TASK'
                and role_type = 'OPERATOR';

                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
                and scope = 'REQUEST_TASK_EXECUTE'
                and permission = 'PERM_INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS_EXECUTE_TASK'
                and role_type = 'OPERATOR';

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('processRequestTaskAction')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'OPERATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('getTaskItemInfoById')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'OPERATOR'
                and r.scope = 'REQUEST_TASK_VIEW';

                delete
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_EXECUTE';


                delete
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_installation_inspection_operator_respond_request_action_installation_inspection_application_submitted_authorization_rules" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMITTED', 'requestActionViewHandler', 'OPERATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_AUDIT_APPLICATION_SUBMITTED', 'requestActionViewHandler', 'OPERATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMITTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'OPERATOR'
            and scope is null;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMITTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'OPERATOR'
            and scope is null;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_installation_inspction_request_action_authorization_rules_rollback" author="dimitrios.topalidis@trasys.gr">
        <sql>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEW_REQUESTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEWER_ACCEPTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEWER_REJECTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_CANCELLED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEW_REQUESTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope is null;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEWER_ACCEPTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope is null;


            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEWER_REJECTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope is null;


            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_SUBMITTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope is null;


            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_CANCELLED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope is null;
        </sql>
        <rollback>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEW_REQUESTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEWER_ACCEPTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEWER_REJECTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_INSPECTION_APPLICATION_SUBMITTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_INSPECTION_APPLICATION_CANCELLED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEW_REQUESTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEWER_ACCEPTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_PEER_REVIEWER_REJECTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_INSPECTION_APPLICATION_CANCELLED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_installation_onsite_inspection_request_action_authorization_rules" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW_REQUESTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEWER_ACCEPTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEWER_REJECTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMITTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_CANCELLED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW_REQUESTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEWER_ACCEPTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEWER_REJECTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_CANCELLED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;
        </sql>
        <rollback>
            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW_REQUESTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope is null;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEWER_ACCEPTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope is null;


            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEWER_REJECTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope is null;


            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMITTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope is null;


            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_CANCELLED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope is null;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW_REQUESTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEWER_ACCEPTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEWER_REJECTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;


            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_CANCELLED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_installation_audit_request_action_authorization_rules" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW_REQUESTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEWER_ACCEPTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEWER_REJECTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_AUDIT_APPLICATION_SUBMITTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_AUDIT_APPLICATION_CANCELLED', 'requestActionViewHandler', 'REGULATOR');


            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW_REQUESTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEWER_ACCEPTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEWER_REJECTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_CANCELLED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;
        </sql>
        <rollback>
            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW_REQUESTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope is null;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEWER_ACCEPTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope is null;


            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEWER_REJECTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope is null;


            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMITTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope is null;


            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_CANCELLED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope is null;


            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW_REQUESTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEWER_ACCEPTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEWER_REJECTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;


            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_CANCELLED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_dre_ukets_application_peer_review_getDocumentPreview" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
               cross join au_rule r
            where s.name in ('getDocumentPreview')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_DRE_UKETS_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getDocumentPreview')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_DRE_UKETS_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0__installation_inspection_operator_respond_authorization_rules_uploadRequestTaskAttachment" author="dimitrios.topalidis@trasys.gr">
        <sql>

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('uploadRequestTaskAttachment')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'OPERATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('uploadRequestTaskAttachment')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'OPERATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

        </sql>
        <rollback>

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('uploadRequestTaskAttachment')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';


            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('uploadRequestTaskAttachment')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0__installation_inspection_operator_respond_authorization_rules_generateRequestTaskGetFileAttachmentToken" author="dimitrios.topalidis@trasys.gr">
        <sql>

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('generateRequestTaskGetFileAttachmentToken')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'OPERATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('generateRequestTaskGetFileAttachmentToken')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'OPERATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

        </sql>
        <rollback>

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('generateRequestTaskGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';


            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('generateRequestTaskGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_installation_inspection_operator_respond_authorization_rules_getCandidateAssigneesByTaskId_assignTask" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
              cross join au_rule r
            where s.name in ('getCandidateAssigneesByTaskId','assignTask')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_VIEW';


            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
              cross join au_rule r
            where s.name in ('getCandidateAssigneesByTaskId','assignTask')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_VIEW';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getCandidateAssigneesByTaskId','assignTask')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getCandidateAssigneesByTaskId','assignTask')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPOND_TO_FOLLOWUP_ACTIONS'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_installation_inspection_application_peer_review_request_task_execute_missing_authorization_rules" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'INSTALLATION_ONSITE_INSPECTION_WAIT_FOR_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'INSTALLATION_AUDIT_WAIT_FOR_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');
        </sql>
        <rollback>
            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_EXECUTE';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_WAIT_FOR_PEER_REVIEW'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_EXECUTE';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_EXECUTE';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'INSTALLATION_AUDIT_WAIT_FOR_PEER_REVIEW'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>

    <changeSet id="0_2_0_aviation_aer_corsia_annual_offsetting_cancel_getRequestActionById" author="kourisp@unisystems.eu">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_CANCELLED',
                    'requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_CANCELLED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'REGULATOR'
              and r.scope IS NULL;

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_CANCELLED',
                    'requestActionViewHandler', 'OPERATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_CANCELLED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'OPERATOR'
              and r.scope IS NULL;

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_CANCELLED',
                    'requestActionAccountBasedViewHandler', 'VERIFIER');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_CANCELLED'
              and r.handler = 'requestActionAccountBasedViewHandler'
              and r.role_type = 'VERIFIER'
              and r.scope IS NULL;

        </sql>
        <rollback>
            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_CANCELLED'
            AND handler = 'requestActionAccountBasedViewHandler'
            AND role_type = 'VERIFIER';

            DELETE FROM au_service_rule
            USING au_rule r
            JOIN au_service s ON s.id = au_service_rule.service_id
            WHERE au_service_rule.rule_id = r.id
            AND s.name = 'getRequestActionById'
            AND r.resource_type = 'REQUEST_ACTION'
            AND r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_CANCELLED'
            AND r.handler = 'requestActionAccountBasedViewHandler'
            AND r.role_type = 'VERIFIER'
            AND r.scope IS NULL;

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_CANCELLED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'OPERATOR';

            DELETE FROM au_service_rule
            USING au_rule r
            JOIN au_service s ON s.id = au_service_rule.service_id
            WHERE au_service_rule.rule_id = r.id
            AND s.name = 'getRequestActionById'
            AND r.resource_type = 'REQUEST_ACTION'
            AND r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_CANCELLED'
            AND r.handler = 'requestActionViewHandler'
            AND r.role_type = 'OPERATOR'
            AND r.scope IS NULL;

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_CANCELLED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR';

            DELETE FROM au_service_rule
            USING au_rule r
            JOIN au_service s ON s.id = au_service_rule.service_id
            WHERE au_service_rule.rule_id = r.id
            AND s.name = 'getRequestActionById'
            AND r.resource_type = 'REQUEST_ACTION'
            AND r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_CANCELLED'
            AND r.handler = 'requestActionViewHandler'
            AND r.role_type = 'REGULATOR'
            AND r.scope IS NULL;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_aer_corsia_annual_offsetting_submitted_getRequestActionById" author="kourisp@unisystems.eu">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMITTED',
                    'requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMITTED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'REGULATOR'
              and r.scope IS NULL;

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMITTED',
                    'requestActionViewHandler', 'OPERATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMITTED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'OPERATOR'
              and r.scope IS NULL;

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMITTED',
                    'requestActionAccountBasedViewHandler', 'VERIFIER');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMITTED'
              and r.handler = 'requestActionAccountBasedViewHandler'
              and r.role_type = 'VERIFIER'
              and r.scope IS NULL;

        </sql>
        <rollback>

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMITTED'
            AND handler = 'requestActionAccountBasedViewHandler'
            AND role_type = 'VERIFIER';

            DELETE FROM au_service_rule
            USING au_rule r
            JOIN au_service s ON s.id = au_service_rule.service_id
            WHERE au_service_rule.rule_id = r.id
            AND s.name = 'getRequestActionById'
            AND r.resource_type = 'REQUEST_ACTION'
            AND r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMITTED'
            AND r.handler = 'requestActionAccountBasedViewHandler'
            AND r.role_type = 'VERIFIER'
            AND r.scope IS NULL;

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMITTED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'OPERATOR';

            DELETE FROM au_service_rule
            USING au_rule r
            JOIN au_service s ON s.id = au_service_rule.service_id
            WHERE au_service_rule.rule_id = r.id
            AND s.name = 'getRequestActionById'
            AND r.resource_type = 'REQUEST_ACTION'
            AND r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMITTED'
            AND r.handler = 'requestActionViewHandler'
            AND r.role_type = 'OPERATOR'
            AND r.scope IS NULL;

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMITTED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR';

            DELETE FROM au_service_rule
            USING au_rule r
            JOIN au_service s ON s.id = au_service_rule.service_id
            WHERE au_service_rule.rule_id = r.id
            AND s.name = 'getRequestActionById'
            AND r.resource_type = 'REQUEST_ACTION'
            AND r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMITTED'
            AND r.handler = 'requestActionViewHandler'
            AND r.role_type = 'REGULATOR'
            AND r.scope IS NULL;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_aer_corsia_annual_offsetting_processRequestCreateAction" author="kourisp@unisystems.eu">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'ACCOUNT', 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING', 'accountRequestCreateHandler', 'REGULATOR', 'REQUEST_CREATE');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'ACCOUNT',
                        'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING',
                        'REQUEST_CREATE',
                        'PERM_AVIATION_AER_ANNUAL_OFFSETTING_APPLICATION_SUBMIT_EXECUTE_TASK',
                        'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('processRequestCreateAction')
              and r.resource_type = 'ACCOUNT'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING'
              and r.handler = 'accountRequestCreateHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_CREATE';

        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT s.id
            FROM au_service s
            WHERE s.name = 'processRequestCreateAction'
            )
            AND rule_id IN (
            SELECT r.id
            FROM au_rule r
            WHERE r.resource_type = 'ACCOUNT'
            AND r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING'
            AND r.handler = 'accountRequestCreateHandler'
            AND r.role_type = 'REGULATOR'
            AND r.scope = 'REQUEST_CREATE'
            );

            DELETE FROM au_resource_scope_permission
            WHERE resource_type = 'ACCOUNT'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING'
            AND scope = 'REQUEST_CREATE'
            AND permission = 'PERM_AVIATION_AER_ANNUAL_OFFSETTING_APPLICATION_SUBMIT_EXECUTE_TASK'
            AND role_type = 'REGULATOR';

            DELETE FROM au_rule
            WHERE resource_type = 'ACCOUNT'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING'
            AND handler = 'accountRequestCreateHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_CREATE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_aer_corsia_annual_offsetting_save_submit_processRequestTaskAction" author="kourisp@unisystems.eu">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMIT',
                    'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMIT',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_AVIATION_AER_ANNUAL_OFFSETTING_APPLICATION_SUBMIT_EXECUTE_TASK',
                        'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('processRequestTaskAction')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMIT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

        </sql>
        <rollback>

            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT s.id
            FROM au_service s
            WHERE s.name = 'processRequestTaskAction'
            )
            AND rule_id IN (
            SELECT r.id
            FROM au_rule r
            WHERE r.resource_type = 'REQUEST_TASK'
            AND r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMIT'
            AND r.handler = 'requestTaskAccessHandler'
            AND r.role_type = 'REGULATOR'
            AND r.scope = 'REQUEST_TASK_EXECUTE'
            );

            DELETE FROM au_resource_scope_permission
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMIT'
            AND scope = 'REQUEST_TASK_EXECUTE'
            AND permission = 'PERM_AVIATION_AER_ANNUAL_OFFSETTING_APPLICATION_SUBMIT_EXECUTE_TASK'
            AND role_type = 'REGULATOR';

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMIT'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_EXECUTE';

        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_aer_corsia_annual_offsetting_save_submit_view_extra_services" author="kourisp@unisystems.eu">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMIT',
                    'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMIT',
                        'REQUEST_TASK_VIEW',
                        'PERM_AVIATION_AER_ANNUAL_OFFSETTING_APPLICATION_SUBMIT_VIEW_TASK',
                        'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getCandidateAssigneesByTaskId','assignTask', 'getTaskItemInfoById', 'getCandidateAssigneesByTaskId', 'getCandidateAssigneesByTaskType')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMIT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';

        </sql>
        <rollback>

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getCandidateAssigneesByTaskId','assignTask', 'getTaskItemInfoById', 'getCandidateAssigneesByTaskId', 'getCandidateAssigneesByTaskType')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            DELETE FROM au_resource_scope_permission
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMIT'
            AND scope = 'REQUEST_TASK_VIEW'
            AND permission = 'PERM_AVIATION_AER_ANNUAL_OFFSETTING_APPLICATION_SUBMIT_VIEW_TASK'
            AND role_type = 'REGULATOR';

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMIT'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_VIEW';

        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_aer_corsia_annual_offsetting_peer_review_rules" author="kourisp@unisystems.eu">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_WAIT_FOR_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_WAIT_FOR_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW',
                        'REQUEST_TASK_VIEW',
                        'PERM_AVIATION_AER_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW_VIEW_TASK',
                        'REGULATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_AVIATION_AER_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW_EXECUTE_TASK',
                        'REGULATOR');


            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('processRequestTaskAction')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('processRequestTaskAction')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_WAIT_FOR_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE service_id IN (SELECT id FROM au_service WHERE name = 'processRequestTaskAction')
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_WAIT_FOR_PEER_REVIEW'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_EXECUTE');

            DELETE FROM au_service_rule
            WHERE service_id IN (SELECT id FROM au_service WHERE name = 'processRequestTaskAction')
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_EXECUTE');

            DELETE FROM au_resource_scope_permission
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW'
            AND scope = 'REQUEST_TASK_EXECUTE'
            AND permission = 'PERM_AVIATION_AER_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW_EXECUTE_TASK'
            AND role_type = 'REGULATOR';

            DELETE FROM au_resource_scope_permission
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW'
            AND scope = 'REQUEST_TASK_VIEW'
            AND permission = 'PERM_AVIATION_AER_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW_VIEW_TASK'
            AND role_type = 'REGULATOR';

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_WAIT_FOR_PEER_REVIEW'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_EXECUTE';

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_WAIT_FOR_PEER_REVIEW'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_VIEW';

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_EXECUTE';

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_aer_corsia_annual_offsetting_wait_peer_review_permissions" author="kourisp@unisystems.eu">
        <sql>
            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_WAIT_FOR_PEER_REVIEW',
                        'REQUEST_TASK_VIEW',
                        'PERM_AVIATION_AER_ANNUAL_OFFSETTING_APPLICATION_SUBMIT_VIEW_TASK',
                        'REGULATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_WAIT_FOR_PEER_REVIEW',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_AVIATION_AER_ANNUAL_OFFSETTING_APPLICATION_SUBMIT_EXECUTE_TASK',
                        'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getTaskItemInfoById')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getTaskItemInfoById')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_WAIT_FOR_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';
        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE service_id IN (SELECT id FROM au_service WHERE name = 'getTaskItemInfoById')
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_WAIT_FOR_PEER_REVIEW'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_VIEW');

            DELETE FROM au_service_rule
            WHERE service_id IN (SELECT id FROM au_service WHERE name = 'getTaskItemInfoById')
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_VIEW');

            DELETE FROM au_resource_scope_permission
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_WAIT_FOR_PEER_REVIEW'
            AND scope = 'REQUEST_TASK_EXECUTE'
            AND permission = 'PERM_AVIATION_AER_ANNUAL_OFFSETTING_APPLICATION_SUBMIT_EXECUTE_TASK'
            AND role_type = 'REGULATOR';

            DELETE FROM au_resource_scope_permission
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_WAIT_FOR_PEER_REVIEW'
            AND scope = 'REQUEST_TASK_VIEW'
            AND permission = 'PERM_AVIATION_AER_ANNUAL_OFFSETTING_APPLICATION_SUBMIT_VIEW_TASK'
            AND role_type = 'REGULATOR';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_aer_corsia_annual_offsetting_peer_review_actions_rules" author="kourisp@unisystems.eu">
        <sql>

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW_REQUESTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW_ACCEPTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW_REJECTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW_REQUESTED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'REGULATOR'
              and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW_ACCEPTED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'REGULATOR'
              and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW_REJECTED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'REGULATOR'
              and r.scope IS NULL;
        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE service_id IN (SELECT id FROM au_service WHERE name = 'getRequestActionById')
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW_REJECTED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR'
            AND scope IS NULL);

            DELETE FROM au_service_rule
            WHERE service_id IN (SELECT id FROM au_service WHERE name = 'getRequestActionById')
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW_ACCEPTED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR'
            AND scope IS NULL);

            DELETE FROM au_service_rule
            WHERE service_id IN (SELECT id FROM au_service WHERE name = 'getRequestActionById')
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW_REQUESTED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR'
            AND scope IS NULL);

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW_REJECTED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR';

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW_ACCEPTED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR';

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW_REQUESTED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_aer_aviation_corsia_annual_offsetting_peer_review_getCandidateAssigneesByTaskType_rule" author="kourisp@unisystems.eu">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getCandidateAssigneesByTaskType')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';

        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getCandidateAssigneesByTaskType')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_installation_inspection_peer_review_authorization_rules_getCandidateAssigneesByTaskType" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getCandidateAssigneesByTaskType')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';


            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getCandidateAssigneesByTaskType')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getCandidateAssigneesByTaskType')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';


            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getCandidateAssigneesByTaskType')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_installation_inspection_peer_review_authorization_rules_generateRequestTaskGetFileAttachmentToken" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('generateRequestTaskGetFileAttachmentToken')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('generateRequestTaskGetFileAttachmentToken')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('generateRequestTaskGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('generateRequestTaskGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_aer_corsia_annual_offsetting_notify_operator_authorization_rules" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
               cross join au_rule r
            where s.name in ('getDocumentPreview')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getDocumentPreview')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_aer_aviation_corsia_annual_offsetting_peer_review_release_assignee_rule" author="kourisp@unisystems.eu">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where name in ('assignTask', 'releaseTask')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';

        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE (service_id, rule_id) IN (
            SELECT s.id, r.id
            FROM au_service s
            CROSS JOIN au_rule r
            WHERE s.name IN ('assignTask', 'releaseTask')
            AND r.resource_type = 'REQUEST_TASK'
            AND r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW'
            AND r.handler = 'requestTaskAccessHandler'
            AND r.role_type = 'REGULATOR'
            AND r.scope = 'REQUEST_TASK_VIEW'
            );
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_installation_inspection_peer_review_authorization_rules_update_processRequestTaskAction_service_rule_scope" author="dimitrios.topalidis@trasys.gr">
        <sql>
            update au_service_rule
            set rule_id = (select id from au_rule where resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
                      and resource_type = 'REQUEST_TASK'
                      and handler = 'requestTaskAccessHandler'
                      and role_type = 'REGULATOR'
                        and scope = 'REQUEST_TASK_EXECUTE')
            where service_id = (select id from au_service where name='processRequestTaskAction')
            and rule_id = ( select id from au_rule where resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
                      and resource_type = 'REQUEST_TASK'
                      and handler = 'requestTaskAccessHandler'
                      and role_type = 'REGULATOR'
                        and scope = 'REQUEST_TASK_VIEW');

            update au_service_rule
            set rule_id = (select id from au_rule where resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_WAIT_FOR_PEER_REVIEW'
                      and resource_type = 'REQUEST_TASK'
                      and handler = 'requestTaskAccessHandler'
                      and role_type = 'REGULATOR'
                        and scope = 'REQUEST_TASK_EXECUTE')
            where service_id = (select id from au_service where name='processRequestTaskAction')
            and rule_id = ( select id from au_rule where resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_WAIT_FOR_PEER_REVIEW'
                      and resource_type = 'REQUEST_TASK'
                      and handler = 'requestTaskAccessHandler'
                      and role_type = 'REGULATOR'
                        and scope = 'REQUEST_TASK_VIEW');

            update au_service_rule
            set rule_id = (select id from au_rule where resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
                      and resource_type = 'REQUEST_TASK'
                      and handler = 'requestTaskAccessHandler'
                      and role_type = 'REGULATOR'
                        and scope = 'REQUEST_TASK_EXECUTE')
            where service_id = (select id from au_service where name='processRequestTaskAction')
            and rule_id = ( select id from au_rule where resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
                      and resource_type = 'REQUEST_TASK'
                      and handler = 'requestTaskAccessHandler'
                      and role_type = 'REGULATOR'
                        and scope = 'REQUEST_TASK_VIEW');

            update au_service_rule
            set rule_id = (select id from au_rule where resource_sub_type = 'INSTALLATION_AUDIT_WAIT_FOR_PEER_REVIEW'
                      and resource_type = 'REQUEST_TASK'
                      and handler = 'requestTaskAccessHandler'
                      and role_type = 'REGULATOR'
                        and scope = 'REQUEST_TASK_EXECUTE')
            where service_id = (select id from au_service where name='processRequestTaskAction')
            and rule_id = ( select id from au_rule where resource_sub_type = 'INSTALLATION_AUDIT_WAIT_FOR_PEER_REVIEW'
                      and resource_type = 'REQUEST_TASK'
                      and handler = 'requestTaskAccessHandler'
                      and role_type = 'REGULATOR'
                        and scope = 'REQUEST_TASK_VIEW');
        </sql>
        <rollback>
            <sql>
                update au_service_rule
                set rule_id = (select id from au_rule where resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
                          and resource_type = 'REQUEST_TASK'
                          and handler = 'requestTaskAccessHandler'
                          and role_type = 'REGULATOR'
                            and scope = 'REQUEST_TASK_VIEW')
                where service_id = (select id from au_service where name='processRequestTaskAction')
                and rule_id = ( select id from au_rule where resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
                          and resource_type = 'REQUEST_TASK'
                          and handler = 'requestTaskAccessHandler'
                          and role_type = 'REGULATOR'
                            and scope = 'REQUEST_TASK_EXECUTE');

                update au_service_rule
                set rule_id = (select id from au_rule where resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_WAIT_FOR_PEER_REVIEW'
                          and resource_type = 'REQUEST_TASK'
                          and handler = 'requestTaskAccessHandler'
                          and role_type = 'REGULATOR'
                            and scope = 'REQUEST_TASK_VIEW')
                where service_id = (select id from au_service where name='processRequestTaskAction')
                and rule_id = ( select id from au_rule where resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_WAIT_FOR_PEER_REVIEW'
                          and resource_type = 'REQUEST_TASK'
                          and handler = 'requestTaskAccessHandler'
                          and role_type = 'REGULATOR'
                            and scope = 'REQUEST_TASK_EXECUTE');

                update au_service_rule
                set rule_id = (select id from au_rule where resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
                          and resource_type = 'REQUEST_TASK'
                          and handler = 'requestTaskAccessHandler'
                          and role_type = 'REGULATOR'
                            and scope = 'REQUEST_TASK_VIEW')
                where service_id = (select id from au_service where name='processRequestTaskAction')
                and rule_id = ( select id from au_rule where resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
                          and resource_type = 'REQUEST_TASK'
                          and handler = 'requestTaskAccessHandler'
                          and role_type = 'REGULATOR'
                            and scope = 'REQUEST_TASK_EXECUTE');

                update au_service_rule
                set rule_id = (select id from au_rule where resource_sub_type = 'INSTALLATION_AUDIT_WAIT_FOR_PEER_REVIEW'
                          and resource_type = 'REQUEST_TASK'
                          and handler = 'requestTaskAccessHandler'
                          and role_type = 'REGULATOR'
                            and scope = 'REQUEST_TASK_VIEW')
                where service_id = (select id from au_service where name='processRequestTaskAction')
                and rule_id = ( select id from au_rule where resource_sub_type = 'INSTALLATION_AUDIT_WAIT_FOR_PEER_REVIEW'
                          and resource_type = 'REQUEST_TASK'
                          and handler = 'requestTaskAccessHandler'
                          and role_type = 'REGULATOR'
                            and scope = 'REQUEST_TASK_EXECUTE');
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_aer_aviation_corsia_annual_offsetting_peer_review_getCandidateAssigneesByTaskId_rule" author="kourisp@unisystems.eu">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where name in ('getCandidateAssigneesByTaskId')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where name in ('getCandidateAssigneesByTaskId', 'releaseTask', 'assignTask')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_WAIT_FOR_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';


            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('releaseTask')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMIT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';

        </sql>
        <rollback>

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('releaseTask')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            DELETE FROM au_service_rule
            WHERE (service_id, rule_id) IN (
            SELECT s.id, r.id
            FROM au_service s
            CROSS JOIN au_rule r
            where name in ('getCandidateAssigneesByTaskId', 'releaseTask', 'assignTask')
            AND r.resource_type = 'REQUEST_TASK'
            AND r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_WAIT_FOR_PEER_REVIEW'
            AND r.handler = 'requestTaskAccessHandler'
            AND r.role_type = 'REGULATOR'
            AND r.scope = 'REQUEST_TASK_VIEW'
            );

            DELETE FROM au_service_rule
            WHERE (service_id, rule_id) IN (
            SELECT s.id, r.id
            FROM au_service s
            CROSS JOIN au_rule r
            where name in ('getCandidateAssigneesByTaskId')
            AND r.resource_type = 'REQUEST_TASK'
            AND r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW'
            AND r.handler = 'requestTaskAccessHandler'
            AND r.role_type = 'REGULATOR'
            AND r.scope = 'REQUEST_TASK_VIEW'
            );
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_aer_aviation_corsia_annual_offsetting_peer_review_installation_operator_response_rule" author="kourisp@unisystems.eu">
        <sql>

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type) values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPONDED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id from au_service s
               cross join au_rule r where s.name in ('getRequestActionById')
                  and r.resource_type = 'REQUEST_ACTION' and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPONDED'
                  and r.handler = 'requestActionViewHandler' and r.role_type = 'REGULATOR' and r.scope IS NULL;

        </sql>
        <rollback>

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPONDED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPONDED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope is null;

        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_aer_aviation_corsia_annual_offsetting_peer_review_audit_operator_response_rule" author="kourisp@unisystems.eu">
        <sql>

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type) values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'INSTALLATION_AUDIT_OPERATOR_RESPONDED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id from au_service s
               cross join au_rule r where s.name in ('getRequestActionById')
                  and r.resource_type = 'REQUEST_ACTION' and r.resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPONDED'
                  and r.handler = 'requestActionViewHandler' and r.role_type = 'REGULATOR' and r.scope IS NULL;

        </sql>
        <rollback>

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPONDED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'INSTALLATION_AUDIT_OPERATOR_RESPONDED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope is null;

        </rollback>
    </changeSet>
    <changeSet id="0_2_0_au_installation_inspection_operator_and_regulator_request_actions_generateRequestActionGetFileDocumentToken_generateRequestActionGetFileAttachmentToken" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('generateRequestActionGetFileDocumentToken', 'generateRequestActionGetFileAttachmentToken')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type in ('INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMITTED', 'INSTALLATION_AUDIT_APPLICATION_SUBMITTED')
              and r.handler = 'requestActionViewHandler'
              and r.role_type in ('REGULATOR', 'OPERATOR')
              and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('generateRequestActionGetFileAttachmentToken')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type in ('INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPONDED', 'INSTALLATION_AUDIT_OPERATOR_RESPONDED')
              and r.handler = 'requestActionViewHandler'
              and r.role_type in ('REGULATOR', 'OPERATOR')
              and r.scope IS NULL;
        </sql>
        <rollback>

            delete from au_service_rule where (service_id, rule_id) in (
            select asvc.id, ar.id from au_service_rule asr
                join au_service asvc on asr.service_id = asvc.id
                join au_rule ar on asr.rule_id = ar.id
                where
                    asr.rule_id in (select id from au_rule where resource_sub_type in ('INSTALLATION_ONSITE_INSPECTION_APPLICATION_SUBMITTED', 'INSTALLATION_AUDIT_APPLICATION_SUBMITTED'))
                    and
                    asr.service_id in (select id from au_service where name in ('generateRequestActionGetFileDocumentToken', 'generateRequestActionGetFileAttachmentToken'))
                    and
                    ar."handler" = 'requestActionViewHandler'
                    and
                    ar.role_type in ('REGULATOR', 'OPERATOR')
                    and
                    ar.scope IS NULL
            );

            delete from au_service_rule where (service_id, rule_id) in (
            select asvc.id, ar.id from au_service_rule asr
                join au_service asvc on asr.service_id = asvc.id
                join au_rule ar on asr.rule_id = ar.id
                where
                    asr.rule_id in (select id from au_rule where resource_sub_type in ('INSTALLATION_ONSITE_INSPECTION_OPERATOR_RESPONDED', 'INSTALLATION_AUDIT_OPERATOR_RESPONDED'))
                    and
                    asr.service_id in (select id from au_service where name in ('generateRequestActionGetFileAttachmentToken'))
                    and
                    ar."handler" = 'requestActionViewHandler'
                    and
                    ar.role_type in ('REGULATOR', 'OPERATOR')
                    and
                    ar.scope IS NULL
            );

        </rollback>
    </changeSet>
    <changeSet id="0_2_0_create_au_service_rule_getDocumentPreview_installation_audit_peer_review" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
            cross join au_rule r
            where s.name = 'getDocumentPreview'
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'getDocumentPreview'
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'INSTALLATION_AUDIT_APPLICATION_PEER_REVIEW'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_create_au_service_rule_getDocumentPreview_installation_onsite_inspection_peer_review" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
            cross join au_rule r
            where s.name = 'getDocumentPreview'
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'getDocumentPreview'
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'INSTALLATION_ONSITE_INSPECTION_APPLICATION_PEER_REVIEW'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_add_rule_for_request_action_sub_type_AER_APPLICATION_REVIEW_SKIPPED" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'),
                    'REQUEST_ACTION' ,
                    'AER_APPLICATION_REVIEW_SKIPPED',
                    'requestActionViewHandler',
                    'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'),
                    'REQUEST_ACTION' ,
                    'AER_APPLICATION_REVIEW_SKIPPED',
                    'requestActionViewHandler',
                    'OPERATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'),
                    'REQUEST_ACTION' ,
                    'AER_APPLICATION_REVIEW_SKIPPED',
                    'requestActionAccountBasedViewHandler',
                    'VERIFIER');
        </sql>
        <rollback>
            <sql>
                delete from au_rule
                where resource_type = 'REQUEST_ACTION'
                and resource_sub_type = 'AER_APPLICATION_REVIEW_SKIPPED'
                and handler = 'requestActionViewHandler'
                and role_type in ('REGULATOR', 'OPERATOR')
                and scope is null;

                delete from au_rule
                where resource_type = 'REQUEST_ACTION'
                and resource_sub_type = 'AER_APPLICATION_REVIEW_SKIPPED'
                and handler = 'requestActionAccountBasedViewHandler'
                and role_type in ('VERIFIER')
                and scope is null;
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_associate_services_with_rule_for_request_action_type_AER_APPLICATION_REVIEW_SKIPPED" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AER_APPLICATION_REVIEW_SKIPPED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type in ('REGULATOR', 'OPERATOR')
              and r.scope is null;


            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AER_APPLICATION_REVIEW_SKIPPED'
              and r.handler = 'requestActionAccountBasedViewHandler'
              and r.role_type in ('VERIFIER')
              and r.scope is null;
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
                and r.resource_type = 'REQUEST_ACTION'
                and r.resource_sub_type = 'AER_APPLICATION_REVIEW_SKIPPED'
                and r.handler = 'requestActionViewHandler'
                and r.role_type in ('REGULATOR', 'OPERATOR')
                and r.scope is null;

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
                and r.resource_type = 'REQUEST_ACTION'
                and r.resource_sub_type = 'AER_APPLICATION_REVIEW_SKIPPED'
                and r.handler = 'requestActionViewHandler'
                and r.role_type in ('requestActionViewHandler')
                and r.scope is null;
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_aer_corsia_3year_period_offsetting_processRequestCreateAction" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'ACCOUNT', 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING', 'accountRequestCreateHandler', 'REGULATOR', 'REQUEST_CREATE');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'ACCOUNT',
                        'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING',
                        'REQUEST_CREATE',
                        'PERM_AVIATION_AER_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT_EXECUTE_TASK',
                        'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('processRequestCreateAction')
              and r.resource_type = 'ACCOUNT'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING'
              and r.handler = 'accountRequestCreateHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_CREATE'
        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT s.id
            FROM au_service s
            WHERE s.name = 'processRequestCreateAction'
            )
            AND rule_id IN (
            SELECT r.id
            FROM au_rule r
            WHERE r.resource_type = 'ACCOUNT'
            AND r.resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING'
            AND r.handler = 'accountRequestCreateHandler'
            AND r.role_type = 'REGULATOR'
            AND r.scope = 'REQUEST_CREATE'
            );

            DELETE FROM au_resource_scope_permission
            WHERE resource_type = 'ACCOUNT'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING'
            AND scope = 'REQUEST_CREATE'
            AND permission = 'PERM_AVIATION_AER_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT_EXECUTE_TASK'
            AND role_type = 'REGULATOR';

            DELETE FROM au_rule
            WHERE resource_type = 'ACCOUNT'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING'
            AND handler = 'accountRequestCreateHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_CREATE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_aer_corsia_3year_period_offsetting_save_submit_view_extra_services" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT',
                    'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT',
                        'REQUEST_TASK_VIEW',
                        'PERM_AVIATION_AER_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT_VIEW_TASK',
                        'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getCandidateAssigneesByTaskId','assignTask', 'getTaskItemInfoById', 'releaseTask', 'getCandidateAssigneesByTaskType')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';

        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getCandidateAssigneesByTaskId','assignTask', 'getTaskItemInfoById', 'releaseTask', 'getCandidateAssigneesByTaskType')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            DELETE FROM au_resource_scope_permission
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT'
            AND scope = 'REQUEST_TASK_VIEW'
            AND permission = 'PERM_AVIATION_AER_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT_VIEW_TASK'
            AND role_type = 'REGULATOR';

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_aer_corsia_3year_period_offsetting_save_submit_processRequestTaskAction" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT',
                    'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_AVIATION_AER_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT_EXECUTE_TASK',
                        'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('processRequestTaskAction')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT s.id
            FROM au_service s
            WHERE s.name = 'processRequestTaskAction'
            )
            AND rule_id IN (
            SELECT r.id
            FROM au_rule r
            WHERE r.resource_type = 'REQUEST_TASK'
            AND r.resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT'
            AND r.handler = 'requestTaskAccessHandler'
            AND r.role_type = 'REGULATOR'
            AND r.scope = 'REQUEST_TASK_EXECUTE'
            );

            DELETE FROM au_resource_scope_permission
            WHERE resource_type = 'ACCOUNT'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT'
            AND scope = 'REQUEST_TASK_EXECUTE'
            AND permission = 'PERM_AVIATION_AER_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT_EXECUTE_TASK'
            AND role_type = 'REGULATOR';

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aer_mark_as_not_required_service_rules_adaptation_requestAccess" author="alekopoulosD@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST', 'AER',
                    'requestAccessHandler', 'REGULATOR', 'REQUEST_MARK_NOT_REQUIRED');

            delete from au_service_rule sr where service_id in (
                select id
                from au_service
                where name in ('markAsNotRequired')
            ) and
                sr.rule_id in (
                    select id
                    from au_rule r
                    where r.resource_type = 'REQUEST'
                      and r.handler = 'requestAccessHandler'
                      and r.role_type = 'REGULATOR'
                      and r.scope IS NULL
                );

            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_rule aur
                     cross join public.au_service aus
            where aus.name in ('markAsNotRequired')
              and aur.resource_type = 'REQUEST'
              and aur.handler = 'requestAccessHandler'
              and aur.scope = 'REQUEST_MARK_NOT_REQUIRED'
              and aur.role_type = 'REGULATOR';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST',
                        'AER',
                        'REQUEST_MARK_NOT_REQUIRED',
                        'PERM_AER_APPLICATION_MARK_NOT_REQUIRED_EXECUTE_TASK',
                        'REGULATOR');
        </sql>
        <rollback>
            DELETE FROM au_resource_scope_permission
            WHERE resource_type = 'REQUEST'
            AND resource_sub_type = 'AER'
            AND scope = 'REQUEST_MARK_NOT_REQUIRED'
            AND permission = 'PERM_AER_APPLICATION_MARK_NOT_REQUIRED_EXECUTE_TASK'
            AND role_type = 'REGULATOR';


            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_rule aur
            cross join public.au_service aus
            where aus.name in ('markAsNotRequired')
            and aur.resource_type = 'REQUEST'
            and aur.handler = 'requestAccessHandler'
            and aur.scope is null
            and aur.role_type = 'REGULATOR';


            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id
            FROM au_service
            WHERE name = 'markAsNotRequired'
            )
            AND rule_id IN (
            SELECT id
            FROM au_rule
            WHERE resource_type = 'REQUEST'
            AND handler = 'requestAccessHandler'
            AND scope = 'REQUEST_MARK_NOT_REQUIRED'
            AND role_type = 'REGULATOR'
            );


            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST'
            AND resource_sub_type = 'AER'
            AND handler = 'requestAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_MARK_NOT_REQUIRED';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aer_mark_as_not_required_team_leader_regulator_role_permissions_enhancement" author="alekopoulosd@unisystems.gr">
        <sql>
            INSERT INTO au_role_permission(id, role_id, permission)
            VALUES (nextval('au_role_permission_seq'),
                    (SELECT id FROM au_role WHERE code = 'regulator_team_leader'),
                    'PERM_AER_APPLICATION_MARK_NOT_REQUIRED_EXECUTE_TASK');
        </sql>
        <rollback>
            DELETE FROM au_role_permission
            WHERE role_id = (SELECT id FROM au_role WHERE code = 'regulator_team_leader')
            AND permission = 'PERM_AER_APPLICATION_MARK_NOT_REQUIRED_EXECUTE_TASK';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_aer_corsia_3year_period_offsetting_peer_review_authorization_rules" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_WAIT_FOR_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_WAIT_FOR_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');


            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'REQUEST_TASK',
            'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW',
            'REQUEST_TASK_VIEW',
            'PERM_AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW_VIEW_TASK',
            'REGULATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'REQUEST_TASK',
            'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW',
            'REQUEST_TASK_EXECUTE',
            'PERM_AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW_EXECUTE_TASK',
            'REGULATOR');


            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'REQUEST_TASK',
            'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_WAIT_FOR_PEER_REVIEW',
            'REQUEST_TASK_VIEW',
            'PERM_AVIATION_AER_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT_VIEW_TASK',
            'REGULATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'REQUEST_TASK',
            'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_WAIT_FOR_PEER_REVIEW',
            'REQUEST_TASK_EXECUTE',
            'PERM_AVIATION_AER_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT_EXECUTE_TASK',
            'REGULATOR');


            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('processRequestTaskAction')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';


            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getTaskItemInfoById','getCandidateAssigneesByTaskId','assignTask','releaseTask')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('processRequestTaskAction')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_WAIT_FOR_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getTaskItemInfoById')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_WAIT_FOR_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';


            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW_REQUESTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW_ACCEPTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW_REJECTED', 'requestActionViewHandler', 'REGULATOR');


            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
             cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW_REQUESTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
             cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW_ACCEPTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
             cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW_REJECTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;
        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('processRequestTaskAction'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_EXECUTE');

            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getTaskItemInfoById','getCandidateAssigneesByTaskId','assignTask','releaseTask'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_VIEW');

            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getTaskItemInfoById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_WAIT_FOR_PEER_REVIEW'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_VIEW');

            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('processRequestTaskAction'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_WAIT_FOR_PEER_REVIEW'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_EXECUTE');


            DELETE FROM au_resource_scope_permission
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW'
            AND scope = 'REQUEST_TASK_VIEW'
            AND permission = 'PERM_AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW_VIEW_TASK'
            AND role_type = 'REGULATOR';

            DELETE FROM au_resource_scope_permission
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW'
            AND scope = 'REQUEST_TASK_EXECUTE'
            AND permission = 'PERM_AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW_EXECUTE_TASK'
            AND role_type = 'REGULATOR';

            DELETE FROM au_resource_scope_permission
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_WAIT_FOR_PEER_REVIEW'
            AND scope = 'REQUEST_TASK_VIEW'
            AND permission = 'PERM_AVIATION_AER_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT_VIEW_TASK'
            AND role_type = 'REGULATOR';

            DELETE FROM au_resource_scope_permission
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_WAIT_FOR_PEER_REVIEW'
            AND scope = 'REQUEST_TASK_EXECUTE'
            AND permission = 'PERM_AVIATION_AER_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT_EXECUTE_TASK'
            AND role_type = 'REGULATOR';



            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_VIEW';

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_EXECUTE';

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_WAIT_FOR_PEER_REVIEW'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_VIEW';

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_WAIT_FOR_PEER_REVIEW'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_EXECUTE';



            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW_REQUESTED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR'
            AND scope IS NULL);


            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW_ACCEPTED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR'
            AND scope IS NULL);

            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW_REJECTED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR'
            AND scope IS NULL);



            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW_REQUESTED'
            and handler = 'requestActionViewHandler'
            and role_type in ('REGULATOR')
            and scope is null;

            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW_ACCEPTED'
            and handler = 'requestActionViewHandler'
            and role_type in ('REGULATOR')
            and scope is null;

            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW_REJECTED'
            and handler = 'requestActionViewHandler'
            and role_type in ('REGULATOR')
            and scope is null;
        </rollback>

    </changeSet>
    <changeSet id="0_2_0_aviation_aer_corsia_3year_period_offsetting_application_submit_authorization_rules_getDocumentPreview" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getDocumentPreview')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getDocumentPreview'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMIT'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_EXECUTE');
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_aer_corsia_3year_period_offsetting_peer_review_authorization_rules_getDocumentPreview" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getDocumentPreview')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getDocumentPreview'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_TASK'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_PEER_REVIEW'
            AND handler = 'requestTaskAccessHandler'
            AND role_type = 'REGULATOR'
            AND scope = 'REQUEST_TASK_EXECUTE');
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_aer_corsia_3year_period_offsetting_peer_review_authorization_rules_application_submitted_action" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMITTED', 'requestActionViewHandler', 'REGULATOR');


            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
             cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;
        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMITTED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR'
            AND scope IS NULL);



            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMITTED'
            and handler = 'requestActionViewHandler'
            and role_type in ('REGULATOR')
            and scope is null;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_aer_corsia_3year_period_offsetting_peer_review_authorization_rules_application_cancelled_action" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_CANCELLED', 'requestActionViewHandler', 'REGULATOR');


            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
             cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_CANCELLED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;
        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_CANCELLED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR'
            AND scope IS NULL);



            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_CANCELLED'
            and handler = 'requestActionViewHandler'
            and role_type in ('REGULATOR')
            and scope is null;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_aer_corsia_3year_period_offsetting_application_submitted_action_operator_authorization_rules" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMITTED',
            'requestActionViewHandler', 'OPERATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMITTED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'OPERATOR'
              and r.scope IS NULL;
        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMITTED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'OPERATOR'
            AND scope IS NULL);

            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AVIATION_AER_CORSIA_3YEAR_PERIOD_OFFSETTING_APPLICATION_SUBMITTED'
            and handler = 'requestActionViewHandler'
            and role_type in ('OPERATOR')
            and scope is null;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_aer_corsia_annual_offsetting_application_peer_review_getDocumentPreview_authorization_rules" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
               cross join au_rule r
            where s.name in ('getDocumentPreview')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getDocumentPreview')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_AER_CORSIA_ANNUAL_OFFSETTING_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_installation_aer_verification_returned_to_operator_request_action_authorization_rules" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AER_VERIFICATION_RETURNED_TO_OPERATOR','requestActionViewHandler', 'OPERATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AER_VERIFICATION_RETURNED_TO_OPERATOR'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'OPERATOR'
              and r.scope IS NULL;

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AER_VERIFICATION_RETURNED_TO_OPERATOR','requestActionAccountBasedViewHandler', 'VERIFIER');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AER_VERIFICATION_RETURNED_TO_OPERATOR'
              and r.handler = 'requestActionAccountBasedViewHandler'
              and r.role_type = 'VERIFIER'
              and r.scope IS NULL;

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AER_VERIFICATION_RETURNED_TO_OPERATOR','requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AER_VERIFICATION_RETURNED_TO_OPERATOR'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'REGULATOR'
              and r.scope IS NULL;
        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AER_VERIFICATION_RETURNED_TO_OPERATOR'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'OPERATOR'
            AND scope IS NULL);

            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AER_VERIFICATION_RETURNED_TO_OPERATOR'
            and handler = 'requestActionViewHandler'
            and role_type in ('OPERATOR')
            and scope is null;

            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AER_VERIFICATION_RETURNED_TO_OPERATOR'
            AND handler = 'requestActionAccountBasedViewHandler'
            AND role_type = 'VERIFIER'
            AND scope IS NULL);

            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AER_VERIFICATION_RETURNED_TO_OPERATOR'
            and handler = 'requestActionAccountBasedViewHandler'
            and role_type in ('VERIFIER')
            and scope is null;

            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AER_VERIFICATION_RETURNED_TO_OPERATOR'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR'
            AND scope IS NULL);

            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AER_VERIFICATION_RETURNED_TO_OPERATOR'
            and handler = 'requestActionViewHandler'
            and role_type in ('REGULATOR')
            and scope is null;
        </rollback>
    </changeSet>

    <changeSet id="0_2_0_aviation_aer_uk_ets_verification_returned_to_operator_request_action_authorization_rules" author="kourisp@unisystems.eu">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AVIATION_AER_UKETS_VERIFICATION_RETURNED_TO_OPERATOR','requestActionViewHandler', 'OPERATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_AER_UKETS_VERIFICATION_RETURNED_TO_OPERATOR'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'OPERATOR'
              and r.scope IS NULL;

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AVIATION_AER_UKETS_VERIFICATION_RETURNED_TO_OPERATOR','requestActionAccountBasedViewHandler', 'VERIFIER');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_AER_UKETS_VERIFICATION_RETURNED_TO_OPERATOR'
              and r.handler = 'requestActionAccountBasedViewHandler'
              and r.role_type = 'VERIFIER'
              and r.scope IS NULL;

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AVIATION_AER_UKETS_VERIFICATION_RETURNED_TO_OPERATOR','requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_AER_UKETS_VERIFICATION_RETURNED_TO_OPERATOR'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'REGULATOR'
              and r.scope IS NULL;
        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_UKETS_VERIFICATION_RETURNED_TO_OPERATOR'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'OPERATOR'
            AND scope IS NULL);

            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AVIATION_AER_UKETS_VERIFICATION_RETURNED_TO_OPERATOR'
            and handler = 'requestActionViewHandler'
            and role_type in ('OPERATOR')
            and scope is null;

            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_UKETS_VERIFICATION_RETURNED_TO_OPERATOR'
            AND handler = 'requestActionAccountBasedViewHandler'
            AND role_type = 'VERIFIER'
            AND scope IS NULL);

            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AVIATION_AER_UKETS_VERIFICATION_RETURNED_TO_OPERATOR'
            and handler = 'requestActionAccountBasedViewHandler'
            and role_type in ('VERIFIER')
            and scope is null;

            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_UKETS_VERIFICATION_RETURNED_TO_OPERATOR'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR'
            AND scope IS NULL);

            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AVIATION_AER_UKETS_VERIFICATION_RETURNED_TO_OPERATOR'
            and handler = 'requestActionViewHandler'
            and role_type in ('REGULATOR')
            and scope is null;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_aer_corsia_verification_returned_to_operator_request_action_authorization_rules" author="kourisp@unisystems.eu">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AVIATION_AER_CORSIA_VERIFICATION_RETURNED_TO_OPERATOR','requestActionViewHandler', 'OPERATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_VERIFICATION_RETURNED_TO_OPERATOR'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'OPERATOR'
              and r.scope IS NULL;

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AVIATION_AER_CORSIA_VERIFICATION_RETURNED_TO_OPERATOR','requestActionAccountBasedViewHandler', 'VERIFIER');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_VERIFICATION_RETURNED_TO_OPERATOR'
              and r.handler = 'requestActionAccountBasedViewHandler'
              and r.role_type = 'VERIFIER'
              and r.scope IS NULL;

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AVIATION_AER_CORSIA_VERIFICATION_RETURNED_TO_OPERATOR','requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_VERIFICATION_RETURNED_TO_OPERATOR'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'REGULATOR'
              and r.scope IS NULL;
        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_VERIFICATION_RETURNED_TO_OPERATOR'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'OPERATOR'
            AND scope IS NULL);

            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AVIATION_AER_CORSIA_VERIFICATION_RETURNED_TO_OPERATOR'
            and handler = 'requestActionViewHandler'
            and role_type in ('OPERATOR')
            and scope is null;

            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_VERIFICATION_RETURNED_TO_OPERATOR'
            AND handler = 'requestActionAccountBasedViewHandler'
            AND role_type = 'VERIFIER'
            AND scope IS NULL);

            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AVIATION_AER_CORSIA_VERIFICATION_RETURNED_TO_OPERATOR'
            and handler = 'requestActionAccountBasedViewHandler'
            and role_type in ('VERIFIER')
            and scope is null;

            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AVIATION_AER_CORSIA_VERIFICATION_RETURNED_TO_OPERATOR'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR'
            AND scope IS NULL);

            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AVIATION_AER_CORSIA_VERIFICATION_RETURNED_TO_OPERATOR'
            and handler = 'requestActionViewHandler'
            and role_type in ('REGULATOR')
            and scope is null;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_APPLICATION_SUBMIT', 'requestTaskAccessHandler', 'OPERATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_APPLICATION_SUBMIT', 'requestTaskAccessHandler', 'OPERATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_service_rule(service_id, rule_id)
              select s.id, r.id
              from au_service s
                       cross join au_rule r
            where s.name in ('getTaskItemInfoById', 'getCandidateAssigneesByTaskId', 'assignTask','releaseTask', 'generateRequestTaskGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('processRequestTaskAction', 'uploadRequestTaskAttachment')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'BDR_APPLICATION_SUBMIT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'OPERATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
                   'REQUEST_TASK',
                   'BDR_APPLICATION_SUBMIT',
                   'REQUEST_TASK_VIEW',
                   'PERM_BDR_APPLICATION_SUBMIT_VIEW_TASK',
                   'OPERATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
               'REQUEST_TASK',
               'BDR_APPLICATION_SUBMIT',
               'REQUEST_TASK_EXECUTE',
               'PERM_BDR_APPLICATION_SUBMIT_EXECUTE_TASK',
               'OPERATOR');
        </sql>
        <rollback>
                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'BDR_APPLICATION_SUBMIT'
                and scope = 'REQUEST_TASK_VIEW'
                and permission = 'PERM_BDR_APPLICATION_SUBMIT_VIEW_TASK'
                and role_type = 'OPERATOR';

                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'BDR_APPLICATION_SUBMIT'
                and scope = 'REQUEST_TASK_EXECUTE'
                and permission = 'PERM_BDR_APPLICATION_SUBMIT_EXECUTE_TASK'
                and role_type = 'OPERATOR';

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('processRequestTaskAction', 'uploadRequestTaskAttachment')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'BDR_APPLICATION_SUBMIT'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'OPERATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('getTaskItemInfoById', 'getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask', 'generateRequestTaskGetFileAttachmentToken')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'BDR_APPLICATION_SUBMIT'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'OPERATOR'
                and r.scope = 'REQUEST_TASK_VIEW';

                delete
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'BDR_APPLICATION_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_EXECUTE';


                delete
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'BDR_APPLICATION_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    
    <changeSet id="0_2_0_rename_getRequestDetailsByAccountId_au_service_to_support_resource" author="P35066">
        <sql>
            update au_service set name = 'getRequestDetailsByResource' where name = 'getRequestDetailsByAccountId';
        </sql>
        <rollback>
        	update au_service set name = 'getRequestDetailsByAccountId' where name = 'getRequestDetailsByResource';
        </rollback>
    </changeSet>
    
    <changeSet id="0_2_0_add_rule_for_CA_access_resource_for_role_REGULATOR_and_associate_with_getRequestDetailsByResource" author="P35066">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'CA' , null, 'caAccessResourceHandler', 'REGULATOR', null);
        </sql>
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name = 'getRequestDetailsByResource'
              and r.resource_type = 'CA'
              and r.resource_sub_type is null
              and r.handler = 'caAccessResourceHandler'
              and r.role_type= 'REGULATOR'
              and r.scope is null;
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'getRequestDetailsByResource'
                and r.resource_type = 'CA'
                and r.resource_sub_type is null
                and r.handler = 'caAccessResourceHandler'
                and r.role_type = 'REGULATOR'
                and r.scope is null;

                delete
                from au_rule
                where resource_type = 'CA'
                and resource_sub_type is null
                and handler = 'caAccessResourceHandler'
                and role_type = 'REGULATOR'
                and scope is null;
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_wait_for_verification_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_WAIT_FOR_VERIFICATION', 'requestTaskAccessHandler', 'OPERATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_WAIT_FOR_VERIFICATION', 'requestTaskAccessHandler', 'OPERATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name = 'processRequestTaskAction'
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'BDR_WAIT_FOR_VERIFICATION'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'OPERATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('assignTask', 'releaseTask', 'getTaskItemInfoById', 'getCandidateAssigneesByTaskId')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_WAIT_FOR_VERIFICATION'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'REQUEST_TASK',
            'BDR_WAIT_FOR_VERIFICATION',
            'REQUEST_TASK_VIEW',
            'PERM_BDR_APPLICATION_SUBMIT_VIEW_TASK',
            'OPERATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'REQUEST_TASK',
            'BDR_WAIT_FOR_VERIFICATION',
            'REQUEST_TASK_EXECUTE',
            'PERM_BDR_APPLICATION_SUBMIT_EXECUTE_TASK',
            'OPERATOR');
        </sql>
        <rollback>
            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_WAIT_FOR_VERIFICATION'
            and scope = 'REQUEST_TASK_VIEW'
            and permission = 'PERM_BDR_APPLICATION_SUBMIT_VIEW_TASK'
            and role_type = 'OPERATOR';


            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_WAIT_FOR_VERIFICATION'
            and scope = 'REQUEST_TASK_EXECUTE'
            and permission = 'PERM_BDR_APPLICATION_SUBMIT_EXECUTE_TASK'
            and role_type = 'OPERATOR';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('assignTask', 'releaseTask', 'getTaskItemInfoById', 'getCandidateAssigneesByTaskId')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_WAIT_FOR_VERIFICATION'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('processRequestTaskAction')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_WAIT_FOR_VERIFICATION'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_WAIT_FOR_VERIFICATION'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'OPERATOR'
            and scope = 'REQUEST_TASK_VIEW';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_WAIT_FOR_VERIFICATION'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'OPERATOR'
            and scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_submit_to_verifier_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_APPLICATION_VERIFICATION_SUBMIT', 'requestTaskAccountBasedAccessHandler', 'VERIFIER', 'REQUEST_TASK_VIEW');

            insert into au_service_rule(service_id, rule_id)
              select s.id, r.id
              from au_service s
                       cross join au_rule r
            where s.name in ('getTaskItemInfoById', 'getCandidateAssigneesByTaskId', 'assignTask','releaseTask', 'generateRequestTaskGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMIT'
            and r.handler = 'requestTaskAccountBasedAccessHandler'
            and r.role_type = 'VERIFIER'
            and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'REQUEST_TASK',
            'BDR_APPLICATION_VERIFICATION_SUBMIT',
            'REQUEST_TASK_VIEW',
            'PERM_BDR_APPLICATION_VERIFICATION_SUBMIT_VIEW_TASK',
            'VERIFIER');

        </sql>
        <rollback>

            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMIT'
            and scope = 'REQUEST_TASK_VIEW'
            and permission = 'PERM_BDR_APPLICATION_VERIFICATION_SUBMIT_VIEW_TASK'
            and role_type = 'VERIFIER';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getTaskItemInfoById', 'getCandidateAssigneesByTaskId', 'assignTask','releaseTask', 'generateRequestTaskGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMIT'
            and r.handler = 'requestTaskAccountBasedAccessHandler'
            and r.role_type = 'VERIFIER'
            and r.scope = 'REQUEST_TASK_VIEW';


            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMIT'
            and handler = 'requestTaskAccountBasedAccessHandler'
            and role_type = 'VERIFIER'
            and scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_application_sent_to_verifier_request_action_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_APPLICATION_SENT_TO_VERIFIER','requestActionViewHandler', 'OPERATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_APPLICATION_SENT_TO_VERIFIER','requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_APPLICATION_SENT_TO_VERIFIER','requestActionAccountBasedViewHandler', 'VERIFIER');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_VERIFIER'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

           insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_VERIFIER'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_VERIFIER'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_VERIFIER'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_VERIFIER'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_VERIFIER'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_SENT_TO_VERIFIER'
            and handler = 'requestActionViewHandler'
            and role_type = 'OPERATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_SENT_TO_VERIFIER'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_SENT_TO_VERIFIER'
            and handler = 'requestActionAccountBasedViewHandler'
            and role_type = 'VERIFIER'
            and scope IS NULL;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_application_recalled_from_verification_request_action_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_RECALLED_FROM_VERIFICATION','requestActionViewHandler', 'OPERATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_RECALLED_FROM_VERIFICATION','requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_RECALLED_FROM_VERIFICATION','requestActionAccountBasedViewHandler', 'VERIFIER');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_RECALLED_FROM_VERIFICATION'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_RECALLED_FROM_VERIFICATION'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_RECALLED_FROM_VERIFICATION'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_RECALLED_FROM_VERIFICATION'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_RECALLED_FROM_VERIFICATION'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_RECALLED_FROM_VERIFICATION'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_RECALLED_FROM_VERIFICATION'
            and handler = 'requestActionViewHandler'
            and role_type = 'OPERATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_RECALLED_FROM_VERIFICATION'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_RECALLED_FROM_VERIFICATION'
            and handler = 'requestActionAccountBasedViewHandler'
            and role_type = 'VERIFIER'
            and scope IS NULL;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_wait_for_regulator_review_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_WAIT_FOR_REGULATOR_REVIEW', 'requestTaskAccessHandler', 'OPERATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_WAIT_FOR_REGULATOR_REVIEW', 'requestTaskAccessHandler', 'OPERATOR', 'REQUEST_TASK_EXECUTE');


            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('assignTask', 'releaseTask', 'getTaskItemInfoById', 'getCandidateAssigneesByTaskId')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_WAIT_FOR_REGULATOR_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'REQUEST_TASK',
            'BDR_WAIT_FOR_REGULATOR_REVIEW',
            'REQUEST_TASK_VIEW',
            'PERM_BDR_APPLICATION_SUBMIT_VIEW_TASK',
            'OPERATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'REQUEST_TASK',
            'BDR_WAIT_FOR_REGULATOR_REVIEW',
            'REQUEST_TASK_EXECUTE',
            'PERM_BDR_APPLICATION_SUBMIT_EXECUTE_TASK',
            'OPERATOR');
        </sql>
        <rollback>

            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_WAIT_FOR_REGULATOR_REVIEW'
            and scope = 'REQUEST_TASK_EXECUTE'
            and permission = 'PERM_BDR_APPLICATION_SUBMIT_EXECUTE_TASK'
            and role_type = 'OPERATOR';

            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_WAIT_FOR_REGULATOR_REVIEW'
            and scope = 'REQUEST_TASK_VIEW'
            and permission = 'PERM_BDR_APPLICATION_SUBMIT_VIEW_TASK'
            and role_type = 'OPERATOR';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('assignTask', 'releaseTask', 'getTaskItemInfoById', 'getCandidateAssigneesByTaskId')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_WAIT_FOR_REGULATOR_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_WAIT_FOR_REGULATOR_REVIEW'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'OPERATOR'
            and scope = 'REQUEST_TASK_EXECUTE';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_WAIT_FOR_REGULATOR_REVIEW'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'OPERATOR'
            and scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_application_regulator_review_submit_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'REQUEST_TASK',
            'BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT',
            'REQUEST_TASK_VIEW',
            'PERM_BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT_VIEW_TASK',
            'REGULATOR');


            insert into au_service_rule(service_id, rule_id)
              select s.id, r.id
              from au_service s
                       cross join au_rule r
            where s.name in ('assignTask', 'releaseTask', 'getTaskItemInfoById', 'generateRequestTaskGetFileAttachmentToken', 'getCandidateAssigneesByTaskId')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('assignTask', 'releaseTask', 'getTaskItemInfoById', 'generateRequestTaskGetFileAttachmentToken', 'getCandidateAssigneesByTaskId')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';


            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT'
            and scope = 'REQUEST_TASK_VIEW'
            and permission = 'PERM_BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT_VIEW_TASK'
            and role_type = 'REGULATOR';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_application_sent_to_regulator_request_action_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_APPLICATION_SENT_TO_REGULATOR','requestActionViewHandler', 'OPERATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_APPLICATION_SENT_TO_REGULATOR','requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_REGULATOR'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_REGULATOR'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_REGULATOR'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_REGULATOR'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_SENT_TO_REGULATOR'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_SENT_TO_REGULATOR'
            and handler = 'requestActionViewHandler'
            and role_type = 'OPERATOR'
            and scope IS NULL;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_submit_to_verifier_authorization_rules_2" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_APPLICATION_VERIFICATION_SUBMIT', 'requestTaskAccountBasedAccessHandler', 'VERIFIER', 'REQUEST_TASK_EXECUTE');

            insert into au_service_rule(service_id, rule_id)
              select s.id, r.id
              from au_service s
                       cross join au_rule r
            where s.name in ('processRequestTaskAction', 'uploadRequestTaskAttachment')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMIT'
            and r.handler = 'requestTaskAccountBasedAccessHandler'
            and r.role_type = 'VERIFIER'
            and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'REQUEST_TASK',
            'BDR_APPLICATION_VERIFICATION_SUBMIT',
            'REQUEST_TASK_EXECUTE',
            'PERM_BDR_APPLICATION_VERIFICATION_SUBMIT_EXECUTE_TASK',
            'VERIFIER');

        </sql>
        <rollback>
            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMIT'
            and scope = 'REQUEST_TASK_EXECUTE'
            and permission = 'PERM_BDR_APPLICATION_VERIFICATION_SUBMIT_EXECUTE_TASK'
            and role_type = 'VERIFIER';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('processRequestTaskAction', 'uploadRequestTaskAttachment')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMIT'
            and r.handler = 'requestTaskAccountBasedAccessHandler'
            and r.role_type = 'VERIFIER'
            and r.scope = 'REQUEST_TASK_EXECUTE';


            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMIT'
            and handler = 'requestTaskAccountBasedAccessHandler'
            and role_type = 'VERIFIER'
            and scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_application_sent_to_verifier_request_action_authorization_rules_2" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_VERIFIER'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_VERIFIER'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_VERIFIER'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_VERIFIER'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_VERIFIER'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_VERIFIER'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_application_sent_to_regulator_request_action_authorization_rules_2" author="dimitrios.topalidis@trasys.gr">
        <sql>

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_APPLICATION_SENT_TO_REGULATOR','requestActionAccountBasedViewHandler', 'VERIFIER');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_REGULATOR'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;


            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_REGULATOR'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_REGULATOR'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_REGULATOR'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_REGULATOR'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_SENT_TO_REGULATOR'
            and handler = 'requestActionAccountBasedViewHandler'
            and role_type = 'VERIFIER'
            and scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_REGULATOR'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_REGULATOR'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_SENT_TO_REGULATOR'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_verification_returned_to_operator_request_action_authorization_rules_2" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_VERIFICATION_RETURNED_TO_OPERATOR','requestActionAccountBasedViewHandler', 'VERIFIER');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_VERIFICATION_RETURNED_TO_OPERATOR','requestActionViewHandler', 'OPERATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_VERIFICATION_RETURNED_TO_OPERATOR','requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_VERIFICATION_RETURNED_TO_OPERATOR'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_VERIFICATION_RETURNED_TO_OPERATOR'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_VERIFICATION_RETURNED_TO_OPERATOR'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

        </sql>
        <rollback>

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_VERIFICATION_RETURNED_TO_OPERATOR'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_VERIFICATION_RETURNED_TO_OPERATOR'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_VERIFICATION_RETURNED_TO_OPERATOR'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_VERIFICATION_RETURNED_TO_OPERATOR'
            and handler = 'requestActionAccountBasedViewHandler'
            and role_type = 'VERIFIER'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_VERIFICATION_RETURNED_TO_OPERATOR'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_VERIFICATION_RETURNED_TO_OPERATOR'
            and handler = 'requestActionViewHandler'
            and role_type = 'OPERATOR'
            and scope IS NULL;
        </rollback>

    </changeSet>
    <changeSet id="0_2_0_bdr_application_verification_submitted_request_action_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_APPLICATION_VERIFICATION_SUBMITTED','requestActionAccountBasedViewHandler', 'VERIFIER');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_APPLICATION_VERIFICATION_SUBMITTED','requestActionViewHandler', 'OPERATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_APPLICATION_VERIFICATION_SUBMITTED','requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMITTED'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

        </sql>
        <rollback>

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMITTED'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMITTED'
            and handler = 'requestActionAccountBasedViewHandler'
            and role_type = 'VERIFIER'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMITTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMITTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'OPERATOR'
            and scope IS NULL;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_application_verification_submitted_request_action_authorization_rules_2" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMITTED'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMITTED'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_VERIFICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;
        </rollback>

    </changeSet>
    <changeSet id="0_2_0_bdr_application_regulator_review_submit_authorization_rules_2" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'REQUEST_TASK',
            'BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT',
            'REQUEST_TASK_EXECUTE',
            'PERM_BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT_EXECUTE_TASK',
            'REGULATOR');


            insert into au_service_rule(service_id, rule_id)
              select s.id, r.id
              from au_service s
                       cross join au_rule r
            where s.name in ('processRequestTaskAction', 'uploadRequestTaskAttachment')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';

        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('processRequestTaskAction', 'uploadRequestTaskAttachment')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';


            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT'
            and scope = 'REQUEST_TASK_EXECUTE'
            and permission = 'PERM_BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT_EXECUTE_TASK'
            and role_type = 'REGULATOR';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_regulator_review_returned_for_amends_request_action_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_REGULATOR_REVIEW_RETURNED_FOR_AMENDS','requestActionViewHandler', 'OPERATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_REGULATOR_REVIEW_RETURNED_FOR_AMENDS','requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_REGULATOR_REVIEW_RETURNED_FOR_AMENDS'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_REGULATOR_REVIEW_RETURNED_FOR_AMENDS'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_REGULATOR_REVIEW_RETURNED_FOR_AMENDS'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_REGULATOR_REVIEW_RETURNED_FOR_AMENDS'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;


            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_REGULATOR_REVIEW_RETURNED_FOR_AMENDS'
            and handler = 'requestActionViewHandler'
            and role_type = 'OPERATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_REGULATOR_REVIEW_RETURNED_FOR_AMENDS'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope IS NULL;

        </rollback>
    </changeSet>

    <changeSet id="0_2_0_bdr_amends_submit_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_APPLICATION_AMENDS_SUBMIT', 'requestTaskAccessHandler', 'OPERATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_APPLICATION_AMENDS_SUBMIT', 'requestTaskAccessHandler', 'OPERATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_service_rule(service_id, rule_id)
              select s.id, r.id
              from au_service s
                       cross join au_rule r
            where s.name in ('getTaskItemInfoById', 'getCandidateAssigneesByTaskId', 'assignTask','releaseTask', 'generateRequestTaskGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_APPLICATION_AMENDS_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('processRequestTaskAction', 'uploadRequestTaskAttachment')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'BDR_APPLICATION_AMENDS_SUBMIT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'OPERATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
                   'REQUEST_TASK',
                   'BDR_APPLICATION_AMENDS_SUBMIT',
                   'REQUEST_TASK_VIEW',
                   'PERM_BDR_APPLICATION_AMENDS_SUBMIT_VIEW_TASK',
                   'OPERATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
               'REQUEST_TASK',
               'BDR_APPLICATION_AMENDS_SUBMIT',
               'REQUEST_TASK_EXECUTE',
               'PERM_BDR_APPLICATION_AMENDS_SUBMIT_EXECUTE_TASK',
               'OPERATOR');
        </sql>
        <rollback>
                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'BDR_APPLICATION_AMENDS_SUBMIT'
                and scope = 'REQUEST_TASK_VIEW'
                and permission = 'PERM_BDR_APPLICATION_AMENDS_SUBMIT_VIEW_TASK'
                and role_type = 'OPERATOR';

                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'BDR_APPLICATION_AMENDS_SUBMIT'
                and scope = 'REQUEST_TASK_EXECUTE'
                and permission = 'PERM_BDR_APPLICATION_AMENDS_SUBMIT_EXECUTE_TASK'
                and role_type = 'OPERATOR';

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('processRequestTaskAction', 'uploadRequestTaskAttachment')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'BDR_APPLICATION_AMENDS_SUBMIT'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'OPERATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('getTaskItemInfoById', 'getCandidateAssigneesByTaskId', 'assignTask', 'releaseTask', 'generateRequestTaskGetFileAttachmentToken')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'BDR_APPLICATION_AMENDS_SUBMIT'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'OPERATOR'
                and r.scope = 'REQUEST_TASK_VIEW';

                delete
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'BDR_APPLICATION_AMENDS_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_EXECUTE';


                delete
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'BDR_APPLICATION_AMENDS_SUBMIT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_wait_for_amends_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_WAIT_FOR_AMENDS', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_WAIT_FOR_AMENDS', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');


            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('assignTask', 'releaseTask', 'getTaskItemInfoById', 'getCandidateAssigneesByTaskId')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_WAIT_FOR_AMENDS'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'REQUEST_TASK',
            'BDR_WAIT_FOR_AMENDS',
            'REQUEST_TASK_VIEW',
            'PERM_BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT_VIEW_TASK',
            'REGULATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'REQUEST_TASK',
            'BDR_WAIT_FOR_AMENDS',
            'REQUEST_TASK_EXECUTE',
            'PERM_BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT_EXECUTE_TASK',
            'REGULATOR');
        </sql>
        <rollback>

            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_WAIT_FOR_AMENDS'
            and scope = 'REQUEST_TASK_EXECUTE'
            and permission = 'PERM_BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT_EXECUTE_TASK'
            and role_type = 'REGULATOR';

            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_WAIT_FOR_AMENDS'
            and scope = 'REQUEST_TASK_VIEW'
            and permission = 'PERM_BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT_VIEW_TASK'
            and role_type = 'REGULATOR';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('assignTask', 'releaseTask', 'getTaskItemInfoById', 'getCandidateAssigneesByTaskId')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_WAIT_FOR_AMENDS'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_WAIT_FOR_AMENDS'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_EXECUTE';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_WAIT_FOR_AMENDS'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_amend_wait_for_verification_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_AMEND_WAIT_FOR_VERIFICATION', 'requestTaskAccessHandler', 'OPERATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_AMEND_WAIT_FOR_VERIFICATION', 'requestTaskAccessHandler', 'OPERATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name = 'processRequestTaskAction'
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'BDR_AMEND_WAIT_FOR_VERIFICATION'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'OPERATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('assignTask', 'releaseTask', 'getTaskItemInfoById', 'getCandidateAssigneesByTaskId')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_AMEND_WAIT_FOR_VERIFICATION'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'REQUEST_TASK',
            'BDR_AMEND_WAIT_FOR_VERIFICATION',
            'REQUEST_TASK_VIEW',
            'PERM_BDR_APPLICATION_AMENDS_SUBMIT_VIEW_TASK',
            'OPERATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'REQUEST_TASK',
            'BDR_AMEND_WAIT_FOR_VERIFICATION',
            'REQUEST_TASK_EXECUTE',
            'PERM_BDR_APPLICATION_AMENDS_SUBMIT_EXECUTE_TASK',
            'OPERATOR');
        </sql>
        <rollback>
            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_AMEND_WAIT_FOR_VERIFICATION'
            and scope = 'REQUEST_TASK_VIEW'
            and permission = 'PERM_BDR_APPLICATION_AMENDS_SUBMIT_VIEW_TASK'
            and role_type = 'OPERATOR';


            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_AMEND_WAIT_FOR_VERIFICATION'
            and scope = 'REQUEST_TASK_EXECUTE'
            and permission = 'PERM_BDR_APPLICATION_AMENDS_SUBMIT_EXECUTE_TASK'
            and role_type = 'OPERATOR';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('assignTask', 'releaseTask', 'getTaskItemInfoById', 'getCandidateAssigneesByTaskId')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_AMEND_WAIT_FOR_VERIFICATION'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('processRequestTaskAction')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_AMEND_WAIT_FOR_VERIFICATION'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_AMEND_WAIT_FOR_VERIFICATION'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'OPERATOR'
            and scope = 'REQUEST_TASK_VIEW';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_AMEND_WAIT_FOR_VERIFICATION'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'OPERATOR'
            and scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_amend_verification_submit_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_AMEND_APPLICATION_VERIFICATION_SUBMIT', 'requestTaskAccountBasedAccessHandler', 'VERIFIER', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_AMEND_APPLICATION_VERIFICATION_SUBMIT', 'requestTaskAccountBasedAccessHandler', 'VERIFIER', 'REQUEST_TASK_EXECUTE');


            insert into au_service_rule(service_id, rule_id)
              select s.id, r.id
              from au_service s
                       cross join au_rule r
            where s.name in ('getTaskItemInfoById', 'getCandidateAssigneesByTaskId', 'assignTask','releaseTask', 'generateRequestTaskGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_AMEND_APPLICATION_VERIFICATION_SUBMIT'
            and r.handler = 'requestTaskAccountBasedAccessHandler'
            and r.role_type = 'VERIFIER'
            and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_service_rule(service_id, rule_id)
              select s.id, r.id
              from au_service s
                       cross join au_rule r
            where s.name in ('processRequestTaskAction', 'uploadRequestTaskAttachment')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_AMEND_APPLICATION_VERIFICATION_SUBMIT'
            and r.handler = 'requestTaskAccountBasedAccessHandler'
            and r.role_type = 'VERIFIER'
            and r.scope = 'REQUEST_TASK_EXECUTE';


            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'REQUEST_TASK',
            'BDR_AMEND_APPLICATION_VERIFICATION_SUBMIT',
            'REQUEST_TASK_VIEW',
            'PERM_BDR_APPLICATION_VERIFICATION_SUBMIT_VIEW_TASK',
            'VERIFIER');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'REQUEST_TASK',
            'BDR_AMEND_APPLICATION_VERIFICATION_SUBMIT',
            'REQUEST_TASK_EXECUTE',
            'PERM_BDR_APPLICATION_VERIFICATION_SUBMIT_EXECUTE_TASK',
            'VERIFIER');
        </sql>
        <rollback>

            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_AMEND_APPLICATION_VERIFICATION_SUBMIT'
            and scope = 'REQUEST_TASK_EXECUTE'
            and permission = 'PERM_BDR_APPLICATION_VERIFICATION_SUBMIT_EXECUTE_TASK'
            and role_type = 'VERIFIER';

            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_AMEND_APPLICATION_VERIFICATION_SUBMIT'
            and scope = 'REQUEST_TASK_VIEW'
            and permission = 'PERM_BDR_APPLICATION_VERIFICATION_SUBMIT_VIEW_TASK'
            and role_type = 'VERIFIER';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('processRequestTaskAction', 'uploadRequestTaskAttachment')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_AMEND_APPLICATION_VERIFICATION_SUBMIT'
            and r.handler = 'requestTaskAccountBasedAccessHandler'
            and r.role_type = 'VERIFIER'
            and r.scope = 'REQUEST_TASK_EXECUTE';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getTaskItemInfoById', 'getCandidateAssigneesByTaskId', 'assignTask','releaseTask', 'generateRequestTaskGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_AMEND_APPLICATION_VERIFICATION_SUBMIT'
            and r.handler = 'requestTaskAccountBasedAccessHandler'
            and r.role_type = 'VERIFIER'
            and r.scope = 'REQUEST_TASK_VIEW';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_AMEND_APPLICATION_VERIFICATION_SUBMIT'
            and handler = 'requestTaskAccountBasedAccessHandler'
            and role_type = 'VERIFIER'
            and scope = 'REQUEST_TASK_EXECUTE';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_AMEND_APPLICATION_VERIFICATION_SUBMIT'
            and handler = 'requestTaskAccountBasedAccessHandler'
            and role_type = 'VERIFIER'
            and scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_application_amends_sent_to_verifier_request_action_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_APPLICATION_AMENDS_SENT_TO_VERIFIER','requestActionViewHandler', 'OPERATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_APPLICATION_AMENDS_SENT_TO_VERIFIER','requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_APPLICATION_AMENDS_SENT_TO_VERIFIER','requestActionAccountBasedViewHandler', 'VERIFIER');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById','generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_AMENDS_SENT_TO_VERIFIER'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

           insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById','generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_AMENDS_SENT_TO_VERIFIER'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById','generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_AMENDS_SENT_TO_VERIFIER'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById','generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_AMENDS_SENT_TO_VERIFIER'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById','generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_AMENDS_SENT_TO_VERIFIER'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById','generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_AMENDS_SENT_TO_VERIFIER'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_AMENDS_SENT_TO_VERIFIER'
            and handler = 'requestActionViewHandler'
            and role_type = 'OPERATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_AMENDS_SENT_TO_VERIFIER'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_AMENDS_SENT_TO_VERIFIER'
            and handler = 'requestActionAccountBasedViewHandler'
            and role_type = 'VERIFIER'
            and scope IS NULL;
        </rollback>
    </changeSet>

    <changeSet id="0_2_0_bdr_application_completed_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_APPLICATION_COMPLETED','requestActionViewHandler', 'OPERATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_APPLICATION_COMPLETED','requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_COMPLETED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_COMPLETED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_COMPLETED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_COMPLETED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;


            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_COMPLETED'
            and handler = 'requestActionViewHandler'
            and role_type = 'OPERATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_COMPLETED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope IS NULL;

        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_re_initiate_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'ACCOUNT', 'BDR', 'accountRequestCreateHandler', 'REGULATOR', 'REQUEST_CREATE');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'ACCOUNT',
                        'BDR',
                        'REQUEST_CREATE',
                        'PERM_BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT_EXECUTE_TASK',
                        'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name = 'processRequestCreateAction'
              and r.resource_type = 'ACCOUNT'
              and r.resource_sub_type = 'BDR'
              and r.handler = 'accountRequestCreateHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_CREATE';
        </sql>
        <rollback>

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'processRequestCreateAction'
                and r.resource_type = 'ACCOUNT'
                and r.resource_sub_type = 'BDR'
                and r.handler = 'accountRequestCreateHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_CREATE';

                delete from au_resource_scope_permission
                where resource_type = 'ACCOUNT'
                and resource_sub_type = 'BDR'
                and scope = 'REQUEST_CREATE'
                and permission = 'PERM_BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT_EXECUTE_TASK'
                and role_type = 'REGULATOR';

                delete
                from au_rule
                where resource_type = 'ACCOUNT'
                and resource_sub_type = 'BDR'
                and handler = 'accountRequestCreateHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_CREATE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_regulator_review_submit_authorization_rules_1" author="alekopoulosd@unisystems.gr">
        <sql>
            INSERT INTO au_service_rule (service_id, rule_id) SELECT s.id, r.id FROM au_service s
                CROSS JOIN au_rule r
                WHERE s.name = 'getCandidateAssigneesByTaskType'
                AND r.resource_type = 'REQUEST_TASK'
                AND r.resource_sub_type = 'BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT'
                AND r.handler = 'requestTaskAccessHandler'
                AND r.role_type = 'REGULATOR'
                AND r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getCandidateAssigneesByTaskType')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_wait_for_peer_review_authorization_rules_1" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_WAIT_FOR_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_WAIT_FOR_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name = 'processRequestTaskAction'
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'BDR_WAIT_FOR_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getTaskItemInfoById')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'BDR_WAIT_FOR_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'BDR_WAIT_FOR_PEER_REVIEW',
                        'REQUEST_TASK_VIEW',
                        'PERM_BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT_VIEW_TASK',
                        'REGULATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'BDR_WAIT_FOR_PEER_REVIEW',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT_EXECUTE_TASK',
                        'REGULATOR');
        </sql>
        <rollback>
            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_WAIT_FOR_PEER_REVIEW'
            and scope = 'REQUEST_TASK_EXECUTE'
            and permission = 'PERM_BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT_EXECUTE_TASK'
            and role_type = 'REGULATOR';

            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_WAIT_FOR_PEER_REVIEW'
            and scope = 'REQUEST_TASK_VIEW'
            and permission = 'PERM_BDR_APPLICATION_REGULATOR_REVIEW_SUBMIT_VIEW_TASK'
            and role_type = 'REGULATOR';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('processRequestTaskAction')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_WAIT_FOR_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getTaskItemInfoById')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_WAIT_FOR_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_WAIT_FOR_PEER_REVIEW'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_EXECUTE';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_WAIT_FOR_PEER_REVIEW'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_application_peer_review_authorization_rules_1" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_APPLICATION_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'BDR_APPLICATION_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getTaskItemInfoById','getCandidateAssigneesByTaskId','assignTask','releaseTask', 'processRequestTaskAction')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'BDR_APPLICATION_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getTaskItemInfoById')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'BDR_APPLICATION_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'BDR_APPLICATION_PEER_REVIEW',
                        'REQUEST_TASK_VIEW',
                        'PERM_BDR_APPLICATION_PEER_REVIEW_VIEW_TASK',
                        'REGULATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'BDR_APPLICATION_PEER_REVIEW',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_BDR_APPLICATION_PEER_REVIEW_EXECUTE_TASK',
                        'REGULATOR');
        </sql>
        <rollback>
            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_APPLICATION_PEER_REVIEW'
            and scope = 'REQUEST_TASK_EXECUTE'
            and permission = 'PERM_BDR_APPLICATION_PEER_REVIEW_EXECUTE_TASK'
            and role_type = 'REGULATOR';

            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_APPLICATION_PEER_REVIEW'
            and scope = 'REQUEST_TASK_VIEW'
            and permission = 'PERM_BDR_APPLICATION_PEER_REVIEW_VIEW_TASK'
            and role_type = 'REGULATOR';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getTaskItemInfoById','getCandidateAssigneesByTaskId','assignTask','releaseTask', 'processRequestTaskAction')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getTaskItemInfoById')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'BDR_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_APPLICATION_PEER_REVIEW'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_EXECUTE';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'BDR_APPLICATION_PEER_REVIEW'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_application_peer_review_actions_authorization_rules_1" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'BDR_APPLICATION_PEER_REVIEW_REQUESTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'BDR_APPLICATION_PEER_REVIEW_ACCEPTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'BDR_APPLICATION_PEER_REVIEW_REJECTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'BDR_APPLICATION_PEER_REVIEW_REQUESTED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'REGULATOR'
              and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'BDR_APPLICATION_PEER_REVIEW_ACCEPTED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'REGULATOR'
              and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'BDR_APPLICATION_PEER_REVIEW_REJECTED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'REGULATOR'
              and r.scope IS NULL;
        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'BDR_APPLICATION_PEER_REVIEW_REQUESTED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR'
            AND scope IS NULL);

            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'BDR_APPLICATION_PEER_REVIEW_ACCEPTED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR'
            AND scope IS NULL);

            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'BDR_APPLICATION_PEER_REVIEW_REJECTED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR'
            AND scope IS NULL);



            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_PEER_REVIEW_REQUESTED'
            and handler = 'requestActionViewHandler'
            and role_type in ('REGULATOR')
            and scope is null;

            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_PEER_REVIEW_ACCEPTED'
            and handler = 'requestActionViewHandler'
            and role_type in ('REGULATOR')
            and scope is null;

            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_PEER_REVIEW_REJECTED'
            and handler = 'requestActionViewHandler'
            and role_type in ('REGULATOR')
            and scope is null;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_bdr_re_initiated_request_action_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_APPLICATION_RE_INITIATED','requestActionViewHandler', 'OPERATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_APPLICATION_RE_INITIATED','requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'BDR_APPLICATION_RE_INITIATED','requestActionAccountBasedViewHandler', 'VERIFIER');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_RE_INITIATED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_RE_INITIATED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_RE_INITIATED'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_RE_INITIATED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_RE_INITIATED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'BDR_APPLICATION_RE_INITIATED'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_RE_INITIATED'
            and handler = 'requestActionViewHandler'
            and role_type = 'OPERATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_RE_INITIATED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'BDR_APPLICATION_RE_INITIATED'
            and handler = 'requestActionAccountBasedViewHandler'
            and role_type = 'VERIFIER'
            and scope IS NULL;
        </rollback>
    </changeSet>

    <changeSet id="0_2_0_permanent_cessation_submit_authorization_rules_1" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'ACCOUNT', 'PERMANENT_CESSATION', 'accountRequestCreateHandler', 'REGULATOR', 'REQUEST_CREATE');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'ACCOUNT',
                        'PERMANENT_CESSATION',
                        'REQUEST_CREATE',
                        'PERM_PERMANENT_CESSATION_APPLICATION_SUBMIT_EXECUTE_TASK',
                        'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name = 'processRequestCreateAction'
              and r.resource_type = 'ACCOUNT'
              and r.resource_sub_type = 'PERMANENT_CESSATION'
              and r.handler = 'accountRequestCreateHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_CREATE';


            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'PERMANENT_CESSATION_APPLICATION_SUBMIT', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'PERMANENT_CESSATION_APPLICATION_SUBMIT', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('assignTask','releaseTask', 'processRequestTaskAction')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMIT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getTaskItemInfoById', 'getCandidateAssigneesByTaskId')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMIT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'PERMANENT_CESSATION_APPLICATION_SUBMIT',
                        'REQUEST_TASK_VIEW',
                        'PERM_PERMANENT_CESSATION_APPLICATION_SUBMIT_VIEW_TASK',
                        'REGULATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'PERMANENT_CESSATION_APPLICATION_SUBMIT',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_PERMANENT_CESSATION_APPLICATION_SUBMIT_EXECUTE_TASK',
                        'REGULATOR');
        </sql>
        <rollback>
            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMIT'
            and scope = 'REQUEST_TASK_EXECUTE'
            and permission = 'PERM_PERMANENT_CESSATION_APPLICATION_SUBMIT_EXECUTE_TASK'
            and role_type = 'REGULATOR';

            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMIT'
            and scope = 'REQUEST_TASK_VIEW'
            and permission = 'PERM_PERMANENT_CESSATION_APPLICATION_SUBMIT_VIEW_TASK'
            and role_type = 'REGULATOR';

            DELETE FROM au_service_rule
            WHERE (service_id, rule_id) IN (
            SELECT s.id, r.id
            FROM au_service s
            CROSS JOIN au_rule r
            WHERE s.name IN ('getTaskItemInfoById', 'getCandidateAssigneesByTaskId')
            AND r.resource_type = 'REQUEST_TASK'
            AND r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMIT'
            AND r.handler = 'requestTaskAccessHandler'
            AND r.role_type = 'REGULATOR'
            AND r.scope = 'REQUEST_TASK_VIEW'
            );

            DELETE FROM au_service_rule
            WHERE (service_id, rule_id) IN (
            SELECT s.id, r.id
            FROM au_service s
            CROSS JOIN au_rule r
            WHERE s.name IN ('assignTask','releaseTask', 'processRequestTaskAction')
            AND r.resource_type = 'REQUEST_TASK'
            AND r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMIT'
            AND r.handler = 'requestTaskAccessHandler'
            AND r.role_type = 'REGULATOR'
            AND r.scope = 'REQUEST_TASK_EXECUTE'
            );

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMIT'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_EXECUTE';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMIT'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_VIEW';


            delete from au_resource_scope_permission
            where resource_type = 'ACCOUNT'
            and resource_sub_type = 'PERMANENT_CESSATION'
            and scope = 'REQUEST_CREATE'
            and permission = 'PERM_PERMANENT_CESSATION_APPLICATION_SUBMIT_EXECUTE_TASK'
            and role_type = 'REGULATOR';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('processRequestCreateAction')
            and r.resource_type = 'ACCOUNT'
            and r.resource_sub_type = 'PERMANENT_CESSATION'
            and r.handler = 'accountRequestCreateHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_CREATE';

            delete
            from au_rule
            where resource_type = 'ACCOUNT'
            and resource_sub_type = 'PERMANENT_CESSATION'
            and handler = 'accountRequestCreateHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_CREATE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_permanent_cessation_authorization_rules_application_cancelled_action" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'PERMANENT_CESSATION_APPLICATION_CANCELLED', 'requestActionViewHandler', 'REGULATOR');


            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_CANCELLED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'REGULATOR'
              and r.scope IS NULL;
        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_CANCELLED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR'
            AND scope IS NULL);


            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_CANCELLED'
            and handler = 'requestActionViewHandler'
            and role_type in ('REGULATOR')
            and scope is null;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_permanent_cessation_authorization_rules_application_submitted_request_actions" author="kourisp@unisystems.gr">
        <sql>
            -- Timeline request action
            INSERT INTO au_rule(id, resource_type, resource_sub_type, handler, role_type)
            VALUES
                (nextval('au_rule_seq'), 'REQUEST_ACTION', 'PERMANENT_CESSATION_SUBMITTED', 'requestActionViewHandler', 'REGULATOR'),
                (nextval('au_rule_seq'), 'REQUEST_ACTION', 'PERMANENT_CESSATION_SUBMITTED', 'requestActionViewHandler', 'OPERATOR'),
                (nextval('au_rule_seq'), 'REQUEST_ACTION', 'PERMANENT_CESSATION_SUBMITTED', 'requestActionAccountBasedViewHandler', 'VERIFIER');

        </sql>
        <rollback>
            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'AER_APPLICATION_REVIEW_SKIPPED'
            AND (
                (handler = 'requestActionViewHandler' AND role_type = 'REGULATOR') OR
                (handler = 'requestActionViewHandler' AND role_type = 'OPERATOR') OR
                (handler = 'requestActionAccountBasedViewHandler' AND role_type = 'VERIFIER')
            );

        </rollback>
    </changeSet>
    <changeSet id="0_2_0_permanent_cessation_authorization_rules_upload_files" author="kourisp@unisystems.gr">
        <sql>

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('uploadRequestTaskAttachment')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMIT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE (service_id, rule_id) IN (
                SELECT s.id, r.id
                FROM au_service s
                CROSS JOIN au_rule r
                WHERE s.name = 'uploadRequestTaskAttachment'
                    AND r.resource_type = 'REQUEST_TASK'
                    AND r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMIT'
                    AND r.handler = 'requestTaskAccessHandler'
                    AND r.role_type = 'REGULATOR'
                    AND r.scope = 'REQUEST_TASK_EXECUTE'
            );
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_permanent_cessation_authorization_rules_download_files" author="kourisp@unisystems.gr">
        <sql>

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name = 'generateRequestTaskGetFileAttachmentToken'
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMIT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type in ('REGULATOR', 'OPERATOR', 'VERIFIER')
                and r.scope = 'REQUEST_TASK_VIEW';

        </sql>
        <rollback>
            delete from au_service_rule
            where (service_id, rule_id) in (
                select s.id, r.id
                from au_service s
                cross join au_rule r
                where s.name = 'generateRequestTaskGetFileAttachmentToken'
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMIT'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type in ('REGULATOR', 'OPERATOR', 'VERIFIER')
                and r.scope = 'REQUEST_TASK_VIEW'
            );

        </rollback>
    </changeSet>

    <changeSet id="0_2_0_permanent_cessation_complete_authorization_rules_application_submitted_request_actions" author="kourisp@unisystems.gr">
        <sql>
            -- Timeline request action
            INSERT INTO au_rule(id, resource_type, resource_sub_type, handler, role_type)
            VALUES
                (nextval('au_rule_seq'), 'REQUEST_ACTION', 'PERMANENT_CESSATION_APPLICATION_SUBMITTED', 'requestActionViewHandler', 'REGULATOR'),
                (nextval('au_rule_seq'), 'REQUEST_ACTION', 'PERMANENT_CESSATION_APPLICATION_SUBMITTED', 'requestActionViewHandler', 'OPERATOR'),
                (nextval('au_rule_seq'), 'REQUEST_ACTION', 'PERMANENT_CESSATION_APPLICATION_SUBMITTED', 'requestActionAccountBasedViewHandler', 'VERIFIER');

        </sql>
        <rollback>
            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMITTED'
            AND (
            (handler = 'requestActionViewHandler' AND role_type = 'REGULATOR') OR
            (handler = 'requestActionViewHandler' AND role_type = 'OPERATOR') OR
            (handler = 'requestActionAccountBasedViewHandler' AND role_type = 'VERIFIER')
            );

        </rollback>
    </changeSet>
    <changeSet id="0_2_0_permanent_cessation_wait_for_peer_review_authorization_rules_1" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'PERMANENT_CESSATION_WAIT_FOR_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'PERMANENT_CESSATION_WAIT_FOR_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name = 'processRequestTaskAction'
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'PERMANENT_CESSATION_WAIT_FOR_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getTaskItemInfoById')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'PERMANENT_CESSATION_WAIT_FOR_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'PERMANENT_CESSATION_WAIT_FOR_PEER_REVIEW',
                        'REQUEST_TASK_VIEW',
                        'PERM_PERMANENT_CESSATION_APPLICATION_SUBMIT_VIEW_TASK',
                        'REGULATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'PERMANENT_CESSATION_WAIT_FOR_PEER_REVIEW',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_PERMANENT_CESSATION_APPLICATION_SUBMIT_EXECUTE_TASK',
                        'REGULATOR');
        </sql>
        <rollback>
            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'PERMANENT_CESSATION_WAIT_FOR_PEER_REVIEW'
            and scope = 'REQUEST_TASK_EXECUTE'
            and permission = 'PERM_PERMANENT_CESSATION_APPLICATION_SUBMIT_EXECUTE_TASK'
            and role_type = 'REGULATOR';

            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'PERMANENT_CESSATION_WAIT_FOR_PEER_REVIEW'
            and scope = 'REQUEST_TASK_VIEW'
            and permission = 'PERM_PERMANENT_CESSATION_APPLICATION_SUBMIT_VIEW_TASK'
            and role_type = 'REGULATOR';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('processRequestTaskAction')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'PERMANENT_CESSATION_WAIT_FOR_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getTaskItemInfoById')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'PERMANENT_CESSATION_WAIT_FOR_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'PERMANENT_CESSATION_WAIT_FOR_PEER_REVIEW'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_EXECUTE';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'PERMANENT_CESSATION_WAIT_FOR_PEER_REVIEW'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_permanent_cessation_application_peer_review_authorization_rules_1" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getTaskItemInfoById','getCandidateAssigneesByTaskId','assignTask','releaseTask', 'processRequestTaskAction')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getTaskItemInfoById')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW',
                        'REQUEST_TASK_VIEW',
                        'PERM_PERMANENT_CESSATION_PEER_REVIEW_VIEW_TASK',
                        'REGULATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_PERMANENT_CESSATION_PEER_REVIEW_EXECUTE_TASK',
                        'REGULATOR');
        </sql>
        <rollback>
            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW'
            and scope = 'REQUEST_TASK_EXECUTE'
            and permission = 'PERM_PERMANENT_CESSATION_PEER_REVIEW_EXECUTE_TASK'
            and role_type = 'REGULATOR';

            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW'
            and scope = 'REQUEST_TASK_VIEW'
            and permission = 'PERM_PERMANENT_CESSATION_PEER_REVIEW_VIEW_TASK'
            and role_type = 'REGULATOR';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getTaskItemInfoById','getCandidateAssigneesByTaskId','assignTask','releaseTask', 'processRequestTaskAction')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getTaskItemInfoById')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_EXECUTE';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_permanent_cessation_application_peer_review_actions_authorization_rules_1" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW_REQUESTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW_ACCEPTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION' , 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW_REJECTED', 'requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW_REQUESTED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'REGULATOR'
              and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW_ACCEPTED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'REGULATOR'
              and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW_REJECTED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'REGULATOR'
              and r.scope IS NULL;
        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW_REQUESTED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR'
            AND scope IS NULL);

            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW_ACCEPTED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR'
            AND scope IS NULL);

            DELETE FROM au_service_rule
            WHERE service_id IN (
            SELECT id FROM au_service WHERE name in ('getRequestActionById'))
            AND rule_id IN (SELECT id FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
            AND resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW_REJECTED'
            AND handler = 'requestActionViewHandler'
            AND role_type = 'REGULATOR'
            AND scope IS NULL);



            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW_REQUESTED'
            and handler = 'requestActionViewHandler'
            and role_type in ('REGULATOR')
            and scope is null;

            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW_ACCEPTED'
            and handler = 'requestActionViewHandler'
            and role_type in ('REGULATOR')
            and scope is null;

            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW_REJECTED'
            and handler = 'requestActionViewHandler'
            and role_type in ('REGULATOR')
            and scope is null;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_permanent_cessation_application_submit_authorization_rules_1" author="alekopoulosd@unisystems.gr">
        <sql>
            INSERT INTO au_service_rule (service_id, rule_id) SELECT s.id, r.id FROM au_service s
                                                                                         CROSS JOIN au_rule r
            WHERE s.name = 'getCandidateAssigneesByTaskType'
              AND r.resource_type = 'REQUEST_TASK'
              AND r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMIT'
              AND r.handler = 'requestTaskAccessHandler'
              AND r.role_type = 'REGULATOR'
              AND r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getCandidateAssigneesByTaskType')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_permanent_cessation_authorization_rules_application_complete_action" author="kourisp@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            select nextval('au_rule_seq'), 'REQUEST_ACTION', 'PERMANENT_CESSATION_APPLICATION_SUBMITTED', 'requestActionViewHandler', role
            from (values
                      ('REGULATOR'),
                      ('VERIFIER'),
                      ('OPERATOR')
                 ) as roles(role);


            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     join au_rule r
                          on r.resource_type = 'REQUEST_ACTION'
                              and r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMITTED'
                              and r.handler = 'requestActionViewHandler'
                              and r.role_type in ('REGULATOR', 'VERIFIER', 'OPERATOR')
                              and r.scope IS NULL
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken');


        </sql>
        <rollback>
            delete from au_service_rule
            where rule_id in (
                    select id from au_rule
                    where resource_type = 'REQUEST_ACTION'
                    and resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMITTED'
                    and handler = 'requestActionViewHandler'
                    and role_type in ('REGULATOR', 'VERIFIER', 'OPERATOR')
                    and scope IS NULL
                )
                    and service_id in (
                        select id from au_service
                        where name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken'));


            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMITTED'
            and handler = 'requestActionViewHandler'
            and role_type in ('REGULATOR', 'VERIFIER', 'OPERATOR')
            and scope IS NULL;

        </rollback>
    </changeSet>
    <changeSet id="0_2_0_permanent_cessation_authorization_rules_application_submitted_duplicate_remove" author="kourisp@unisystems.gr">
        <sql>
            DELETE FROM au_service_rule
            WHERE rule_id IN (
                SELECT r.id
                FROM au_rule r
                WHERE r.resource_type = 'REQUEST_ACTION'
                  AND r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMITTED'
                  AND r.handler = 'requestActionViewHandler'
                  AND r.role_type IN ('REGULATOR', 'OPERATOR')
                  AND r.scope IS NULL
                  AND r.id NOT IN (
                    SELECT MIN(id)
                    FROM au_rule
                    WHERE resource_type = 'REQUEST_ACTION'
                      AND resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMITTED'
                      AND handler = 'requestActionViewHandler'
                      AND role_type IN ('REGULATOR', 'OPERATOR')
                      AND scope IS NULL
                    GROUP BY role_type
                )
            );

            DELETE FROM au_rule
            WHERE resource_type = 'REQUEST_ACTION'
              AND resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMITTED'
              AND handler = 'requestActionViewHandler'
              AND role_type IN ('REGULATOR', 'OPERATOR')
              AND scope IS NULL
              AND id NOT IN (
                SELECT MIN(id)
                FROM au_rule
                WHERE resource_type = 'REQUEST_ACTION'
                  AND resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMITTED'
                  AND handler = 'requestActionViewHandler'
                  AND role_type IN ('REGULATOR', 'OPERATOR')
                  AND scope IS NULL
                GROUP BY role_type
            );

            UPDATE au_rule SET handler = 'requestActionAccountBasedViewHandler'
            WHERE resource_type = 'REQUEST_ACTION' AND resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMITTED'
              AND handler = 'requestActionViewHandler' AND role_type = 'VERIFIER';
        </sql>
        <rollback>
            UPDATE au_rule
            SET handler = 'requestActionViewHandler'
            WHERE resource_type = 'REQUEST_ACTION'
                AND resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMITTED'
                AND handler = 'requestActionAccountBasedViewHandler'
                AND role_type = 'VERIFIER';
        </rollback>
    </changeSet>

    <changeSet id="0_2_0_permanent_cessation_regulator_submit_getDocumentPreview_authorization_rules" author="kourisp@unisystems.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getDocumentPreview')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMIT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getDocumentPreview')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_permanent_cessation_peer_review_getDocumentPreview_authorization_rules" author="kourisp@unisystems.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getDocumentPreview')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getDocumentPreview')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'PERMANENT_CESSATION_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>

    <changeSet id="0_2_0_aviation_doe_corsia_request_create_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'ACCOUNT', 'AVIATION_DOE_CORSIA', 'accountRequestCreateHandler', 'REGULATOR', 'REQUEST_CREATE');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
            cross join au_rule r
            where s.name = 'processRequestCreateAction'
            and r.resource_type = 'ACCOUNT'
            and r.resource_sub_type = 'AVIATION_DOE_CORSIA'
            and r.handler = 'accountRequestCreateHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_CREATE';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
            'ACCOUNT',
            'AVIATION_DOE_CORSIA',
            'REQUEST_CREATE',
            'PERM_AVIATION_DOE_CORSIA_APPLICATION_SUBMIT_EXECUTE_TASK',
            'REGULATOR');

        </sql>
        <rollback>

            delete from au_resource_scope_permission
            where resource_type = 'ACCOUNT'
            and resource_sub_type = 'AVIATION_DOE_CORSIA'
            and scope = 'REQUEST_CREATE'
            and permission = 'PERM_AVIATION_DOE_CORSIA_APPLICATION_SUBMIT_EXECUTE_TASK'
            and role_type = 'REGULATOR';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name = 'processRequestCreateAction'
            and r.resource_type = 'ACCOUNT'
            and r.resource_sub_type = 'AVIATION_DOE_CORSIA'
            and r.handler = 'accountRequestCreateHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_CREATE';

            delete
            from au_rule
            where resource_type = 'ACCOUNT'
            and resource_sub_type = 'AVIATION_DOE_CORSIA'
            and handler = 'accountRequestCreateHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_CREATE';

        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_doe_corsia_application_submit_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'AVIATION_DOE_CORSIA_APPLICATION_SUBMIT', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'AVIATION_DOE_CORSIA_APPLICATION_SUBMIT', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_EXECUTE');


            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
            (select nextval('au_resource_scope_permission_seq'),
                'REQUEST_TASK',
                'AVIATION_DOE_CORSIA_APPLICATION_SUBMIT',
                'REQUEST_TASK_VIEW',
                'PERM_AVIATION_DOE_CORSIA_APPLICATION_SUBMIT_VIEW_TASK',
                'REGULATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                'REQUEST_TASK',
                'AVIATION_DOE_CORSIA_APPLICATION_SUBMIT',
                'REQUEST_TASK_EXECUTE',
                'PERM_AVIATION_DOE_CORSIA_APPLICATION_SUBMIT_EXECUTE_TASK',
                'REGULATOR');


            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('assignTask', 'getCandidateAssigneesByTaskId', 'releaseTask', 'getTaskItemInfoById', 'generateRequestTaskGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';


            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('processRequestTaskAction','uploadRequestTaskAttachment')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('processRequestTaskAction','uploadRequestTaskAttachment')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('assignTask', 'getCandidateAssigneesByTaskId', 'releaseTask', 'getTaskItemInfoById', 'generateRequestTaskGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_SUBMIT'
            and scope = 'REQUEST_TASK_EXECUTE'
            and permission = 'PERM_AVIATION_DOE_CORSIA_APPLICATION_SUBMIT_EXECUTE_TASK'
            and role_type = 'REGULATOR';

            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_SUBMIT'
            and scope = 'REQUEST_TASK_VIEW'
            and permission = 'PERM_AVIATION_DOE_CORSIA_APPLICATION_SUBMIT_VIEW_TASK'
            and role_type = 'REGULATOR';


            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_SUBMIT'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_VIEW';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_SUBMIT'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'REGULATOR'
            and scope = 'REQUEST_TASK_EXECUTE';

        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_doe_corsia_application_submit_cancelled_request_action_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AVIATION_DOE_CORSIA_SUBMIT_CANCELLED','requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'AVIATION_DOE_CORSIA_SUBMIT_CANCELLED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'AVIATION_DOE_CORSIA_SUBMIT_CANCELLED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AVIATION_DOE_CORSIA_SUBMIT_CANCELLED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope IS NULL;

        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_doe_corsia_submitted_request_action_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'AVIATION_DOE_CORSIA_SUBMITTED','requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'AVIATION_DOE_CORSIA_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById','generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'AVIATION_DOE_CORSIA_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AVIATION_DOE_CORSIA_SUBMITTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope IS NULL;

        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_doe_corsia_make_payment_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'AVIATION_DOE_CORSIA_MAKE_PAYMENT', 'requestTaskAccessHandler', 'OPERATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'),'REQUEST_TASK' ,'AVIATION_DOE_CORSIA_MAKE_PAYMENT','requestTaskAccessHandler','OPERATOR','REQUEST_TASK_EXECUTE');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'AVIATION_DOE_CORSIA_MAKE_PAYMENT',
                        'REQUEST_TASK_VIEW',
                        'PERM_AVIATION_DOE_CORSIA_MAKE_PAYMENT_VIEW_TASK',
                        'OPERATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'AVIATION_DOE_CORSIA_MAKE_PAYMENT',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_AVIATION_DOE_CORSIA_MAKE_PAYMENT_EXECUTE_TASK',
                        'OPERATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getTaskItemInfoById', 'assignTask', 'releaseTask', 'getTaskItemInfoById', 'getCandidateAssigneesByTaskId')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_DOE_CORSIA_MAKE_PAYMENT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'OPERATOR'
              and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('processRequestTaskAction', 'processExistingCardPayment', 'createCardPayment')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_DOE_CORSIA_MAKE_PAYMENT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'OPERATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

        </sql>
        <rollback>

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('processRequestTaskAction', 'processExistingCardPayment', 'createCardPayment')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'AVIATION_DOE_CORSIA_MAKE_PAYMENT'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'OPERATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('getTaskItemInfoById', 'assignTask', 'releaseTask', 'getTaskItemInfoById', 'getCandidateAssigneesByTaskId')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'AVIATION_DOE_CORSIA_MAKE_PAYMENT'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'OPERATOR'
                and r.scope = 'REQUEST_TASK_VIEW';


                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_MAKE_PAYMENT'
                and scope = 'REQUEST_TASK_EXECUTE'
                and permission = 'PERM_AVIATION_DOE_CORSIA_MAKE_PAYMENT_EXECUTE_TASK'
                and role_type = 'OPERATOR';

                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_MAKE_PAYMENT'
                and scope = 'REQUEST_TASK_VIEW'
                and permission = 'PERM_AVIATION_DOE_CORSIA_MAKE_PAYMENT_VIEW_TASK'
                and role_type = 'OPERATOR';

                delete from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_MAKE_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_EXECUTE';

                delete from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_MAKE_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'OPERATOR'
                and scope = 'REQUEST_TASK_VIEW';

        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_doe_corsia_track_payment_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'AVIATION_DOE_CORSIA_TRACK_PAYMENT', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'),'REQUEST_TASK' ,'AVIATION_DOE_CORSIA_TRACK_PAYMENT','requestTaskAccessHandler','REGULATOR','REQUEST_TASK_EXECUTE');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'AVIATION_DOE_CORSIA_TRACK_PAYMENT',
                        'REQUEST_TASK_VIEW',
                        'PERM_AVIATION_DOE_CORSIA_APPLICATION_SUBMIT_VIEW_TASK',
                        'REGULATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'AVIATION_DOE_CORSIA_TRACK_PAYMENT',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_AVIATION_DOE_CORSIA_APPLICATION_SUBMIT_EXECUTE_TASK',
                        'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getTaskItemInfoById', 'assignTask', 'releaseTask', 'getTaskItemInfoById', 'getCandidateAssigneesByTaskId')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_DOE_CORSIA_TRACK_PAYMENT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('processRequestTaskAction')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_DOE_CORSIA_TRACK_PAYMENT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

        </sql>
        <rollback>

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('processRequestTaskAction')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'AVIATION_DOE_CORSIA_TRACK_PAYMENT'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('getTaskItemInfoById', 'assignTask', 'releaseTask', 'getTaskItemInfoById', 'getCandidateAssigneesByTaskId')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'AVIATION_DOE_CORSIA_TRACK_PAYMENT'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_VIEW';


                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_TRACK_PAYMENT'
                and scope = 'REQUEST_TASK_EXECUTE'
                and permission = 'PERM_AVIATION_DOE_CORSIA_APPLICATION_SUBMIT_EXECUTE_TASK'
                and role_type = 'REGULATOR';

                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_TRACK_PAYMENT'
                and scope = 'REQUEST_TASK_VIEW'
                and permission = 'PERM_AVIATION_DOE_CORSIA_APPLICATION_SUBMIT_VIEW_TASK'
                and role_type = 'REGULATOR';

                delete from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_TRACK_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_EXECUTE';

                delete from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_TRACK_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW';

        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_doe_corsia_confirm_payment_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'AVIATION_DOE_CORSIA_CONFIRM_PAYMENT', 'requestTaskAccessHandler', 'REGULATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'),'REQUEST_TASK' ,'AVIATION_DOE_CORSIA_CONFIRM_PAYMENT','requestTaskAccessHandler','REGULATOR','REQUEST_TASK_EXECUTE');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'AVIATION_DOE_CORSIA_CONFIRM_PAYMENT',
                        'REQUEST_TASK_VIEW',
                        'PERM_AVIATION_DOE_CORSIA_APPLICATION_SUBMIT_VIEW_TASK',
                        'REGULATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'AVIATION_DOE_CORSIA_CONFIRM_PAYMENT',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_AVIATION_DOE_CORSIA_APPLICATION_SUBMIT_EXECUTE_TASK',
                        'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getTaskItemInfoById', 'assignTask', 'releaseTask', 'getTaskItemInfoById', 'getCandidateAssigneesByTaskId')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_DOE_CORSIA_CONFIRM_PAYMENT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('processRequestTaskAction')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_DOE_CORSIA_CONFIRM_PAYMENT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

        </sql>
        <rollback>

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('processRequestTaskAction')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'AVIATION_DOE_CORSIA_CONFIRM_PAYMENT'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';

                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('getTaskItemInfoById', 'assignTask', 'releaseTask', 'getTaskItemInfoById', 'getCandidateAssigneesByTaskId')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'AVIATION_DOE_CORSIA_CONFIRM_PAYMENT'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_VIEW';


                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_CONFIRM_PAYMENT'
                and scope = 'REQUEST_TASK_EXECUTE'
                and permission = 'PERM_AVIATION_DOE_CORSIA_APPLICATION_SUBMIT_EXECUTE_TASK'
                and role_type = 'REGULATOR';

                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_CONFIRM_PAYMENT'
                and scope = 'REQUEST_TASK_VIEW'
                and permission = 'PERM_AVIATION_DOE_CORSIA_APPLICATION_SUBMIT_VIEW_TASK'
                and role_type = 'REGULATOR';

                delete from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_CONFIRM_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_EXECUTE';

                delete from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_CONFIRM_PAYMENT'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW';

        </rollback>
    </changeSet>
    <changeSet id="0_2_0_alr_authorization_rules_1" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'ALR_APPLICATION_SUBMIT', 'requestTaskAccessHandler', 'OPERATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'ALR_APPLICATION_SUBMIT', 'requestTaskAccessHandler', 'OPERATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getTaskItemInfoById', 'getCandidateAssigneesByTaskId', 'assignTask')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'ALR_APPLICATION_SUBMIT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'OPERATOR'
              and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('processRequestTaskAction')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'ALR_APPLICATION_SUBMIT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'OPERATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'ALR_APPLICATION_SUBMIT',
                        'REQUEST_TASK_VIEW',
                        'PERM_ALR_APPLICATION_SUBMIT_VIEW_TASK',
                        'OPERATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'ALR_APPLICATION_SUBMIT',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_ALR_APPLICATION_SUBMIT_EXECUTE_TASK',
                        'OPERATOR');
        </sql>
        <rollback>
            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'ALR_APPLICATION_SUBMIT'
            and scope = 'REQUEST_TASK_VIEW'
            and permission = 'PERM_ALR_APPLICATION_SUBMIT_VIEW_TASK'
            and role_type = 'OPERATOR';

            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'ALR_APPLICATION_SUBMIT'
            and scope = 'REQUEST_TASK_EXECUTE'
            and permission = 'PERM_ALR_APPLICATION_SUBMIT_EXECUTE_TASK'
            and role_type = 'OPERATOR';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('processRequestTaskAction')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'ALR_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getTaskItemInfoById', 'getCandidateAssigneesByTaskId', 'assignTask')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'ALR_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'ALR_APPLICATION_SUBMIT'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'OPERATOR'
            and scope = 'REQUEST_TASK_EXECUTE';


            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'ALR_APPLICATION_SUBMIT'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'OPERATOR'
            and scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>

    <changeSet id="0_2_0_permanent_cessation_authorization_rules_permit_notification_application_complete_action" author="kourisp@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            select nextval('au_rule_seq'), 'REQUEST_ACTION', 'PERMIT_NOTIFICATION_APPLICATION_CESSATION_COMPLETED', 'requestActionViewHandler', role
            from (values
                      ('REGULATOR'),
                      ('OPERATOR')
                 ) as roles(role);

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     join au_rule r
                          on r.resource_type = 'REQUEST_ACTION'
                              and r.resource_sub_type = 'PERMIT_NOTIFICATION_APPLICATION_CESSATION_COMPLETED'
                              and r.handler = 'requestActionViewHandler'
                              and r.role_type in ('REGULATOR', 'OPERATOR')
                              and r.scope IS NULL
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken');


        </sql>
        <rollback>
            delete from au_service_rule
            where rule_id in (
            select id from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'PERMIT_NOTIFICATION_APPLICATION_CESSATION_COMPLETED'
            and handler = 'requestActionViewHandler'
            and role_type in ('REGULATOR', 'OPERATOR')
            and scope IS NULL
            )
            and service_id in (
            select id from au_service
            where name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken'));


            delete from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'PERMIT_NOTIFICATION_APPLICATION_CESSATION_COMPLETED'
            and handler = 'requestActionViewHandler'
            and role_type in ('REGULATOR', 'OPERATOR')
            and scope IS NULL;

        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_doe_CORSIA_APPLICATION_CANCELLED_DUE_TO_DOE" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'),
                    'REQUEST_ACTION' ,
                    'AVIATION_AER_CORSIA_APPLICATION_CANCELLED_DUE_TO_DOE',
                    'requestActionViewHandler',
                    'OPERATOR');
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'),
                    'REQUEST_ACTION' ,
                    'AVIATION_AER_CORSIA_APPLICATION_CANCELLED_DUE_TO_DOE',
                    'requestActionViewHandler',
                    'REGULATOR');
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'),
                    'REQUEST_ACTION' ,
                    'AVIATION_AER_CORSIA_APPLICATION_CANCELLED_DUE_TO_DOE',
                    'requestActionAccountBasedViewHandler',
                    'VERIFIER');
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name = 'getRequestActionById'
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_APPLICATION_CANCELLED_DUE_TO_DOE'
              and r.handler = 'requestActionViewHandler'
              and r.role_type in ('OPERATOR', 'REGULATOR');
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name = 'getRequestActionById'
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_AER_CORSIA_APPLICATION_CANCELLED_DUE_TO_DOE'
              and r.handler = 'requestActionAccountBasedViewHandler'
              and r.role_type in ('VERIFIER');
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'getRequestActionById'
                and r.resource_type = 'REQUEST_ACTION'
                and r.resource_sub_type = 'AVIATION_AER_CORSIA_APPLICATION_CANCELLED_DUE_TO_DOE'
                and r.handler = 'requestActionViewHandler'
                and r.role_type in ('OPERATOR', 'REGULATOR');
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'getRequestActionById'
                and r.resource_type = 'REQUEST_ACTION'
                and r.resource_sub_type = 'AVIATION_AER_CORSIA_APPLICATION_CANCELLED_DUE_TO_DOE'
                and r.handler = 'requestActionAccountBasedViewHandler'
                and r.role_type in ('VERIFIER');

                delete from au_rule
                where resource_type = 'REQUEST_ACTION'
                and resource_sub_type = 'AVIATION_AER_CORSIA_APPLICATION_CANCELLED_DUE_TO_DOE'
                and handler = 'requestActionViewHandler'
                and role_type in ('OPERATOR', 'REGULATOR');
                delete from au_rule
                where resource_type = 'REQUEST_ACTION'
                and resource_sub_type = 'AVIATION_AER_CORSIA_APPLICATION_CANCELLED_DUE_TO_DOE'
                and handler = 'requestActionAccountBasedViewHandler'
                and role_type in ('VERIFIER');
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_doe_corsia_submitted_request_action_authorization_rules_2_update" author="alekopoulosD@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'),
                    'REQUEST_ACTION' ,
                    'AVIATION_DOE_CORSIA_SUBMITTED',
                    'requestActionViewHandler',
                    'OPERATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'),
                    'REQUEST_ACTION' ,
                    'AVIATION_DOE_CORSIA_SUBMITTED',
                    'requestActionAccountBasedViewHandler',
                    'VERIFIER');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_DOE_CORSIA_SUBMITTED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'OPERATOR'
              and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'AVIATION_DOE_CORSIA_SUBMITTED'
              and r.handler = 'requestActionAccountBasedViewHandler'
              and r.role_type = 'VERIFIER'
              and r.scope IS NULL;
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'AVIATION_DOE_CORSIA_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'AVIATION_DOE_CORSIA_SUBMITTED'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AVIATION_DOE_CORSIA_SUBMITTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'OPERATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'AVIATION_DOE_CORSIA_SUBMITTED'
            and handler = 'requestActionAccountBasedViewHandler'
            and role_type = 'VERIFIER'
            and scope IS NULL;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_create_au_service_rule_getDocumentPreview_DoE_application_submit" author="alekopoulosD@unisystems.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name = 'getDocumentPreview'
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_SUBMIT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'REGULATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'getDocumentPreview'
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_SUBMIT'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';
            </sql>
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_doe_corsia_peer_review_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'),
                    'REQUEST_TASK' ,
                    'AVIATION_DOE_CORSIA_APPLICATION_PEER_REVIEW',
                    'requestTaskAccessHandler',
                    'REGULATOR',
                    'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'),
                    'REQUEST_TASK' ,
                    'AVIATION_DOE_CORSIA_APPLICATION_PEER_REVIEW',
                    'requestTaskAccessHandler',
                    'REGULATOR',
                    'REQUEST_TASK_EXECUTE');

            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('assignTask', 'releaseTask', 'getTaskItemInfoById', 'generateRequestTaskGetFileAttachmentToken', 'getCandidateAssigneesByTaskId')
              and aur.resource_type = 'REQUEST_TASK'
              and aur.resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_PEER_REVIEW'
              and aur.handler = 'requestTaskAccessHandler'
              and aur.scope = 'REQUEST_TASK_VIEW'
              and aur.role_type = 'REGULATOR';

            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name  in ('processRequestTaskAction')
              and aur.resource_type = 'REQUEST_TASK'
              and aur.resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_PEER_REVIEW'
              and aur.handler = 'requestTaskAccessHandler'
              and aur.scope = 'REQUEST_TASK_EXECUTE'
              and aur.role_type = 'REGULATOR';

           insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'AVIATION_DOE_CORSIA_APPLICATION_PEER_REVIEW',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_AVIATION_DOE_CORSIA_PEER_REVIEW_EXECUTE_TASK',
                        'REGULATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'AVIATION_DOE_CORSIA_APPLICATION_PEER_REVIEW',
                        'REQUEST_TASK_VIEW',
                        'PERM_AVIATION_DOE_CORSIA_PEER_REVIEW_VIEW_TASK',
                        'REGULATOR');
        </sql>
        <rollback>

                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_PEER_REVIEW'
                and scope = 'REQUEST_TASK_VIEW'
                and permission = 'PERM_AVIATION_DOE_CORSIA_PEER_REVIEW_VIEW_TASK'
                and role_type = 'REGULATOR';

                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_PEER_REVIEW'
                and scope = 'REQUEST_TASK_EXECUTE'
                and permission = 'PERM_AVIATION_DOE_CORSIA_PEER_REVIEW_EXECUTE_TASK'
                and role_type = 'REGULATOR';

                delete
                from au_service_rule sr using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('processRequestTaskAction')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_PEER_REVIEW'
                and r.handler = 'requestTaskAccessHandler'
                and r.scope = 'REQUEST_TASK_EXECUTE'
                and r.role_type = 'REGULATOR';

                delete
                from au_service_rule sr using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('assignTask', 'releaseTask', 'getTaskItemInfoById', 'generateRequestTaskGetFileAttachmentToken', 'getCandidateAssigneesByTaskId')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_PEER_REVIEW'
                and r.handler = 'requestTaskAccessHandler'
                and r.scope = 'REQUEST_TASK_VIEW'
                and r.role_type = 'REGULATOR';


                delete
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_PEER_REVIEW'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_EXECUTE';

                delete
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_PEER_REVIEW'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_doe_corsia_peer_review_requested_request_action_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
             insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'),
                    'REQUEST_ACTION' ,
                    'AVIATION_DOE_CORSIA_PEER_REVIEW_REQUESTED',
                    'requestActionViewHandler',
                    'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getRequestActionById')
              and aur.resource_type = 'REQUEST_ACTION'
              and aur.resource_sub_type = 'AVIATION_DOE_CORSIA_PEER_REVIEW_REQUESTED'
              and aur.handler = 'requestActionViewHandler'
              and aur.role_type = 'REGULATOR'
              and aur.scope is null;
        </sql>
        <rollback>
                delete
                from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('getRequestActionById')
                and r.resource_type = 'REQUEST_ACTION'
                and r.resource_sub_type = 'AVIATION_DOE_CORSIA_PEER_REVIEW_REQUESTED'
                and r.handler = 'requestActionViewHandler'
                and r.role_type = 'REGULATOR'
                and r.scope is null;

                delete from au_rule
                where resource_type = 'REQUEST_ACTION'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_PEER_REVIEW_REQUESTED'
                and handler = 'requestActionViewHandler'
                and role_type = 'REGULATOR'
                and scope is null;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_doe_corsia_application_submit_authorization_rules_2" author="dimitrios.topalidis@trasys.gr">
        <sql>

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                 cross join au_rule r
            where s.name in ('getCandidateAssigneesByTaskType')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getCandidateAssigneesByTaskType')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_SUBMIT'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';

        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_doe_corsia_wait_for_peer_review_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
           insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'),
                    'REQUEST_TASK' ,
                    'AVIATION_DOE_CORSIA_WAIT_FOR_PEER_REVIEW',
                    'requestTaskAccessHandler',
                    'REGULATOR',
                    'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'),
                    'REQUEST_TASK' ,
                    'AVIATION_DOE_CORSIA_WAIT_FOR_PEER_REVIEW',
                    'requestTaskAccessHandler',
                    'REGULATOR',
                    'REQUEST_TASK_EXECUTE');

            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('assignTask', 'releaseTask', 'getTaskItemInfoById', 'generateRequestTaskGetFileAttachmentToken', 'getCandidateAssigneesByTaskId')
              and aur.resource_type = 'REQUEST_TASK'
              and aur.resource_sub_type = 'AVIATION_DOE_CORSIA_WAIT_FOR_PEER_REVIEW'
              and aur.handler = 'requestTaskAccessHandler'
              and aur.scope = 'REQUEST_TASK_VIEW'
              and aur.role_type = 'REGULATOR';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'AVIATION_DOE_CORSIA_WAIT_FOR_PEER_REVIEW',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_AVIATION_DOE_CORSIA_APPLICATION_SUBMIT_EXECUTE_TASK',
                        'REGULATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'AVIATION_DOE_CORSIA_WAIT_FOR_PEER_REVIEW',
                        'REQUEST_TASK_VIEW',
                        'PERM_AVIATION_DOE_CORSIA_APPLICATION_SUBMIT_VIEW_TASK',
                        'REGULATOR');
        </sql>
        <rollback>
                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_WAIT_FOR_PEER_REVIEW'
                and scope = 'REQUEST_TASK_VIEW'
                and permission = 'PERM_AVIATION_DOE_CORSIA_APPLICATION_SUBMIT_VIEW_TASK'
                and role_type = 'REGULATOR';

                delete from au_resource_scope_permission
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_WAIT_FOR_PEER_REVIEW'
                and scope = 'REQUEST_TASK_EXECUTE'
                and permission = 'PERM_AVIATION_DOE_CORSIA_APPLICATION_SUBMIT_EXECUTE_TASK'
                and role_type = 'REGULATOR';

                delete
                from au_service_rule sr using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('assignTask', 'releaseTask', 'getTaskItemInfoById', 'generateRequestTaskGetFileAttachmentToken', 'getCandidateAssigneesByTaskId')
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'AVIATION_DOE_CORSIA_WAIT_FOR_PEER_REVIEW'
                and r.handler = 'requestTaskAccessHandler'
                and r.scope = 'REQUEST_TASK_VIEW'
                and r.role_type = 'REGULATOR';

                delete
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_WAIT_FOR_PEER_REVIEW'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_VIEW';

                delete
                from au_rule
                where resource_type = 'REQUEST_TASK'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_WAIT_FOR_PEER_REVIEW'
                and handler = 'requestTaskAccessHandler'
                and role_type = 'REGULATOR'
                and scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_doe_corsia_peer_review_authorization_rules_2" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
               cross join au_rule r
            where s.name in ('getDocumentPreview')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            and s.name in ('getDocumentPreview')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'AVIATION_DOE_CORSIA_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_aviation_doe_corsia_peer_review_accepted_rejected_request_actions_authorization_rules_1" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'),
                    'REQUEST_ACTION' ,
                    'AVIATION_DOE_CORSIA_PEER_REVIEWER_ACCEPTED',
                    'requestActionViewHandler',
                    'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'),
                    'REQUEST_ACTION' ,
                    'AVIATION_DOE_CORSIA_PEER_REVIEWER_REJECTED',
                    'requestActionViewHandler',
                    'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getRequestActionById')
              and aur.resource_type = 'REQUEST_ACTION'
              and aur.resource_sub_type = 'AVIATION_DOE_CORSIA_PEER_REVIEWER_ACCEPTED'
              and aur.handler = 'requestActionViewHandler'
              and aur.role_type = 'REGULATOR'
              and aur.scope is null;


            insert into au_service_rule(service_id, rule_id)
            select aus.id, aur.id
            from au_service aus
                     cross join au_rule aur
            where aus.name in ('getRequestActionById')
              and aur.resource_type = 'REQUEST_ACTION'
              and aur.resource_sub_type = 'AVIATION_DOE_CORSIA_PEER_REVIEWER_REJECTED'
              and aur.handler = 'requestActionViewHandler'
              and aur.role_type = 'REGULATOR'
              and aur.scope is null;
        </sql>
        <rollback>

                 delete
                from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('getRequestActionById')
                and r.resource_type = 'REQUEST_ACTION'
                and r.resource_sub_type = 'AVIATION_DOE_CORSIA_PEER_REVIEWER_REJECTED'
                and r.handler = 'requestActionViewHandler'
                and r.role_type = 'REGULATOR'
                and r.scope is null;



                delete
                from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name in ('getRequestActionById')
                and r.resource_type = 'REQUEST_ACTION'
                and r.resource_sub_type = 'AVIATION_DOE_CORSIA_PEER_REVIEWER_ACCEPTED'
                and r.handler = 'requestActionViewHandler'
                and r.role_type = 'REGULATOR'
                and r.scope is null;


                delete from au_rule
                where resource_type = 'REQUEST_ACTION'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_PEER_REVIEWER_REJECTED'
                and handler = 'requestActionViewHandler'
                and role_type = 'REGULATOR'
                and scope is null;

                delete from au_rule
                where resource_type = 'REQUEST_ACTION'
                and resource_sub_type = 'AVIATION_DOE_CORSIA_PEER_REVIEWER_ACCEPTED'
                and handler = 'requestActionViewHandler'
                and role_type = 'REGULATOR'
                and scope is null;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_ALR_authorization_rules_upload_files" author="alekopoulosd@unisystems.gr">
        <sql>

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('uploadRequestTaskAttachment')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'ALR_APPLICATION_SUBMIT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'OPERATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE (service_id, rule_id) IN (
            SELECT s.id, r.id
            FROM au_service s
            CROSS JOIN au_rule r
            WHERE s.name = 'uploadRequestTaskAttachment'
            AND r.resource_type = 'REQUEST_TASK'
            AND r.resource_sub_type = 'ALR_APPLICATION_SUBMIT'
            AND r.handler = 'requestTaskAccessHandler'
            AND r.role_type = 'OPERATOR'
            AND r.scope = 'REQUEST_TASK_EXECUTE'
            );
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_ALR_wait_for_verification_authorization_rules_1" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'ALR_WAIT_FOR_VERIFICATION', 'requestTaskAccessHandler', 'OPERATOR', 'REQUEST_TASK_VIEW');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'ALR_WAIT_FOR_VERIFICATION', 'requestTaskAccessHandler', 'OPERATOR', 'REQUEST_TASK_EXECUTE');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name = 'processRequestTaskAction'
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'ALR_WAIT_FOR_VERIFICATION'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'OPERATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('assignTask', 'releaseTask', 'getTaskItemInfoById', 'getCandidateAssigneesByTaskId')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'ALR_WAIT_FOR_VERIFICATION'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'OPERATOR'
              and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'ALR_WAIT_FOR_VERIFICATION',
                        'REQUEST_TASK_VIEW',
                        'PERM_ALR_APPLICATION_SUBMIT_VIEW_TASK',
                        'OPERATOR');

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'ALR_WAIT_FOR_VERIFICATION',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_ALR_APPLICATION_SUBMIT_EXECUTE_TASK',
                        'OPERATOR');
        </sql>
        <rollback>
            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'ALR_WAIT_FOR_VERIFICATION'
            and scope = 'REQUEST_TASK_VIEW'
            and permission = 'PERM_ALR_APPLICATION_SUBMIT_VIEW_TASK'
            and role_type = 'OPERATOR';


            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'ALR_WAIT_FOR_VERIFICATION'
            and scope = 'REQUEST_TASK_EXECUTE'
            and permission = 'PERM_ALR_APPLICATION_SUBMIT_EXECUTE_TASK'
            and role_type = 'OPERATOR';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('assignTask', 'releaseTask', 'getTaskItemInfoById', 'getCandidateAssigneesByTaskId')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'ALR_WAIT_FOR_VERIFICATION'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_VIEW';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('processRequestTaskAction')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'ALR_WAIT_FOR_VERIFICATION'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'OPERATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'ALR_WAIT_FOR_VERIFICATION'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'OPERATOR'
            and scope = 'REQUEST_TASK_VIEW';

            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'ALR_WAIT_FOR_VERIFICATION'
            and handler = 'requestTaskAccessHandler'
            and role_type = 'OPERATOR'
            and scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_alr_submit_to_verifier_authorization_rules_1" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'ALR_APPLICATION_VERIFICATION_SUBMIT', 'requestTaskAccountBasedAccessHandler', 'VERIFIER', 'REQUEST_TASK_VIEW');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getTaskItemInfoById', 'getCandidateAssigneesByTaskId', 'assignTask','releaseTask', 'generateRequestTaskGetFileAttachmentToken')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'ALR_APPLICATION_VERIFICATION_SUBMIT'
              and r.handler = 'requestTaskAccountBasedAccessHandler'
              and r.role_type = 'VERIFIER'
              and r.scope = 'REQUEST_TASK_VIEW';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'ALR_APPLICATION_VERIFICATION_SUBMIT',
                        'REQUEST_TASK_VIEW',
                        'PERM_ALR_APPLICATION_VERIFICATION_SUBMIT_VIEW_TASK',
                        'VERIFIER');

        </sql>
        <rollback>

            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'ALR_APPLICATION_VERIFICATION_SUBMIT'
            and scope = 'REQUEST_TASK_VIEW'
            and permission = 'PERM_ALR_APPLICATION_VERIFICATION_SUBMIT_VIEW_TASK'
            and role_type = 'VERIFIER';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getTaskItemInfoById', 'getCandidateAssigneesByTaskId', 'assignTask','releaseTask', 'generateRequestTaskGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'ALR_APPLICATION_VERIFICATION_SUBMIT'
            and r.handler = 'requestTaskAccountBasedAccessHandler'
            and r.role_type = 'VERIFIER'
            and r.scope = 'REQUEST_TASK_VIEW';


            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'ALR_APPLICATION_VERIFICATION_SUBMIT'
            and handler = 'requestTaskAccountBasedAccessHandler'
            and role_type = 'VERIFIER'
            and scope = 'REQUEST_TASK_VIEW';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_alr_application_sent_to_verifier_request_action_authorization_rules_1" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'ALR_APPLICATION_SENT_TO_VERIFIER','requestActionViewHandler', 'OPERATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'ALR_APPLICATION_SENT_TO_VERIFIER','requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'ALR_APPLICATION_SENT_TO_VERIFIER','requestActionAccountBasedViewHandler', 'VERIFIER');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'ALR_APPLICATION_SENT_TO_VERIFIER'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'OPERATOR'
              and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'ALR_APPLICATION_SENT_TO_VERIFIER'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'REGULATOR'
              and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'ALR_APPLICATION_SENT_TO_VERIFIER'
              and r.handler = 'requestActionAccountBasedViewHandler'
              and r.role_type = 'VERIFIER'
              and r.scope IS NULL;
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'ALR_APPLICATION_SENT_TO_VERIFIER'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'ALR_APPLICATION_SENT_TO_VERIFIER'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken', 'generateRequestActionGetFileDocumentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'ALR_APPLICATION_SENT_TO_VERIFIER'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'ALR_APPLICATION_SENT_TO_VERIFIER'
            and handler = 'requestActionViewHandler'
            and role_type = 'OPERATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'ALR_APPLICATION_SENT_TO_VERIFIER'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'ALR_APPLICATION_SENT_TO_VERIFIER'
            and handler = 'requestActionAccountBasedViewHandler'
            and role_type = 'VERIFIER'
            and scope IS NULL;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_ALR_authorization_rules_update_1" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('releaseTask', 'generateRequestTaskGetFileAttachmentToken')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'ALR_APPLICATION_SUBMIT'
              and r.handler = 'requestTaskAccessHandler'
              and r.role_type = 'OPERATOR'
              and r.scope = 'REQUEST_TASK_EXECUTE';

        </sql>
        <rollback>
            DELETE FROM au_service_rule
            WHERE (service_id, rule_id) IN (
            SELECT s.id, r.id
            FROM au_service s
            CROSS JOIN au_rule r
            WHERE s.name in ('releaseTask', 'generateRequestTaskGetFileAttachmentToken')
            AND r.resource_type = 'REQUEST_TASK'
            AND r.resource_sub_type = 'ALR_APPLICATION_SUBMIT'
            AND r.handler = 'requestTaskAccessHandler'
            AND r.role_type = 'OPERATOR'
            AND r.scope = 'REQUEST_TASK_EXECUTE'
            );
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_alr_submit_to_verifier_authorization_rules_2" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type, scope)
            values (nextval('au_rule_seq'), 'REQUEST_TASK', 'ALR_APPLICATION_VERIFICATION_SUBMIT', 'requestTaskAccountBasedAccessHandler', 'VERIFIER', 'REQUEST_TASK_EXECUTE');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('processRequestTaskAction', 'uploadRequestTaskAttachment')
              and r.resource_type = 'REQUEST_TASK'
              and r.resource_sub_type = 'ALR_APPLICATION_VERIFICATION_SUBMIT'
              and r.handler = 'requestTaskAccountBasedAccessHandler'
              and r.role_type = 'VERIFIER'
              and r.scope = 'REQUEST_TASK_EXECUTE';

            insert into au_resource_scope_permission(id, resource_type, resource_sub_type, scope, permission, role_type)
                (select nextval('au_resource_scope_permission_seq'),
                        'REQUEST_TASK',
                        'ALR_APPLICATION_VERIFICATION_SUBMIT',
                        'REQUEST_TASK_EXECUTE',
                        'PERM_ALR_APPLICATION_VERIFICATION_SUBMIT_EXECUTE_TASK',
                        'VERIFIER');

        </sql>
        <rollback>
            delete from au_resource_scope_permission
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'ALR_APPLICATION_VERIFICATION_SUBMIT'
            and scope = 'REQUEST_TASK_EXECUTE'
            and permission = 'PERM_ALR_APPLICATION_VERIFICATION_SUBMIT_EXECUTE_TASK'
            and role_type = 'VERIFIER';

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('processRequestTaskAction', 'uploadRequestTaskAttachment')
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'ALR_APPLICATION_VERIFICATION_SUBMIT'
            and r.handler = 'requestTaskAccountBasedAccessHandler'
            and r.role_type = 'VERIFIER'
            and r.scope = 'REQUEST_TASK_EXECUTE';


            delete
            from au_rule
            where resource_type = 'REQUEST_TASK'
            and resource_sub_type = 'ALR_APPLICATION_VERIFICATION_SUBMIT'
            and handler = 'requestTaskAccountBasedAccessHandler'
            and role_type = 'VERIFIER'
            and scope = 'REQUEST_TASK_EXECUTE';
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_ALR_application_verification_submitted_request_action_authorization_rules_1" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'ALR_APPLICATION_VERIFICATION_SUBMITTED','requestActionAccountBasedViewHandler', 'VERIFIER');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'ALR_APPLICATION_VERIFICATION_SUBMITTED','requestActionViewHandler', 'OPERATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'ALR_APPLICATION_VERIFICATION_SUBMITTED','requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'ALR_APPLICATION_VERIFICATION_SUBMITTED'
              and r.handler = 'requestActionAccountBasedViewHandler'
              and r.role_type = 'VERIFIER'
              and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'ALR_APPLICATION_VERIFICATION_SUBMITTED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'OPERATOR'
              and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'ALR_APPLICATION_VERIFICATION_SUBMITTED'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'REGULATOR'
              and r.scope IS NULL;
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'ALR_APPLICATION_VERIFICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'ALR_APPLICATION_VERIFICATION_SUBMITTED'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById', 'generateRequestActionGetFileAttachmentToken')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'ALR_APPLICATION_VERIFICATION_SUBMITTED'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'ALR_APPLICATION_VERIFICATION_SUBMITTED'
            and handler = 'requestActionAccountBasedViewHandler'
            and role_type = 'VERIFIER'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'ALR_APPLICATION_VERIFICATION_SUBMITTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'ALR_APPLICATION_VERIFICATION_SUBMITTED'
            and handler = 'requestActionViewHandler'
            and role_type = 'OPERATOR'
            and scope IS NULL;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_ALR_verification_returned_to_operator_request_action_authorization_rules" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'ALR_VERIFICATION_RETURNED_TO_OPERATOR','requestActionAccountBasedViewHandler', 'VERIFIER');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'ALR_VERIFICATION_RETURNED_TO_OPERATOR','requestActionViewHandler', 'OPERATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'ALR_VERIFICATION_RETURNED_TO_OPERATOR','requestActionViewHandler', 'REGULATOR');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'ALR_VERIFICATION_RETURNED_TO_OPERATOR'
              and r.handler = 'requestActionAccountBasedViewHandler'
              and r.role_type = 'VERIFIER'
              and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'ALR_VERIFICATION_RETURNED_TO_OPERATOR'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'OPERATOR'
              and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'ALR_VERIFICATION_RETURNED_TO_OPERATOR'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'REGULATOR'
              and r.scope IS NULL;
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'ALR_VERIFICATION_RETURNED_TO_OPERATOR'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'ALR_VERIFICATION_RETURNED_TO_OPERATOR'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'ALR_VERIFICATION_RETURNED_TO_OPERATOR'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'ALR_VERIFICATION_RETURNED_TO_OPERATOR'
            and handler = 'requestActionAccountBasedViewHandler'
            and role_type = 'VERIFIER'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'ALR_VERIFICATION_RETURNED_TO_OPERATOR'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'ALR_VERIFICATION_RETURNED_TO_OPERATOR'
            and handler = 'requestActionViewHandler'
            and role_type = 'OPERATOR'
            and scope IS NULL;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_ALR_application_recalled_from_verification_request_action_authorization_rules" author="alekopoulosd@unisystems.gr">
        <sql>
            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'ALR_RECALLED_FROM_VERIFICATION','requestActionViewHandler', 'OPERATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'ALR_RECALLED_FROM_VERIFICATION','requestActionViewHandler', 'REGULATOR');

            insert into au_rule(id, resource_type, resource_sub_type, handler, role_type)
            values (nextval('au_rule_seq'), 'REQUEST_ACTION', 'ALR_RECALLED_FROM_VERIFICATION','requestActionAccountBasedViewHandler', 'VERIFIER');

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'ALR_RECALLED_FROM_VERIFICATION'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'OPERATOR'
              and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'ALR_RECALLED_FROM_VERIFICATION'
              and r.handler = 'requestActionViewHandler'
              and r.role_type = 'REGULATOR'
              and r.scope IS NULL;

            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
                     cross join au_rule r
            where s.name in ('getRequestActionById')
              and r.resource_type = 'REQUEST_ACTION'
              and r.resource_sub_type = 'ALR_RECALLED_FROM_VERIFICATION'
              and r.handler = 'requestActionAccountBasedViewHandler'
              and r.role_type = 'VERIFIER'
              and r.scope IS NULL;
        </sql>
        <rollback>
            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'ALR_RECALLED_FROM_VERIFICATION'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'OPERATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'ALR_RECALLED_FROM_VERIFICATION'
            and r.handler = 'requestActionViewHandler'
            and r.role_type = 'REGULATOR'
            and r.scope IS NULL;

            delete from au_service_rule sr
            using
            au_rule r,
            au_service s
            where r.id = sr.rule_id
            and s.id = sr.service_id
            AND s.name in ('getRequestActionById')
            and r.resource_type = 'REQUEST_ACTION'
            and r.resource_sub_type = 'ALR_RECALLED_FROM_VERIFICATION'
            and r.handler = 'requestActionAccountBasedViewHandler'
            and r.role_type = 'VERIFIER'
            and r.scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'ALR_RECALLED_FROM_VERIFICATION'
            and handler = 'requestActionViewHandler'
            and role_type = 'OPERATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'ALR_RECALLED_FROM_VERIFICATION'
            and handler = 'requestActionViewHandler'
            and role_type = 'REGULATOR'
            and scope IS NULL;

            delete
            from au_rule
            where resource_type = 'REQUEST_ACTION'
            and resource_sub_type = 'ALR_RECALLED_FROM_VERIFICATION'
            and handler = 'requestActionAccountBasedViewHandler'
            and role_type = 'VERIFIER'
            and scope IS NULL;
        </rollback>
    </changeSet>
    <changeSet id="0_2_0_create_au_service_rule_getDocumentPreview_permit_notification_application_peer_review" author="dimitrios.topalidis@trasys.gr">
        <sql>
            insert into au_service_rule(service_id, rule_id)
            select s.id, r.id
            from au_service s
            cross join au_rule r
            where s.name = 'getDocumentPreview'
            and r.resource_type = 'REQUEST_TASK'
            and r.resource_sub_type = 'PERMIT_NOTIFICATION_APPLICATION_PEER_REVIEW'
            and r.handler = 'requestTaskAccessHandler'
            and r.role_type = 'REGULATOR'
            and r.scope = 'REQUEST_TASK_EXECUTE';
        </sql>
        <rollback>
            <sql>
                delete from au_service_rule sr
                using
                au_rule r,
                au_service s
                where r.id = sr.rule_id
                and s.id = sr.service_id
                and s.name = 'getDocumentPreview'
                and r.resource_type = 'REQUEST_TASK'
                and r.resource_sub_type = 'PERMIT_NOTIFICATION_APPLICATION_PEER_REVIEW'
                and r.handler = 'requestTaskAccessHandler'
                and r.role_type = 'REGULATOR'
                and r.scope = 'REQUEST_TASK_EXECUTE';
            </sql>
        </rollback>
    </changeSet>
</databaseChangeLog>